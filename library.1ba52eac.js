!function(){function e(e){return e&&e.__esModule?e.default:e}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n={},a={},r=t.parcelRequired7c6;null==r&&((r=function(e){if(e in n)return n[e].exports;if(e in a){var t=a[e];delete a[e];var r={id:e,exports:{}};return n[e]=r,t.call(r.exports,r,r.exports),r.exports}var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(e,t){a[e]=t},t.parcelRequired7c6=r);var o,s,d=r("bpxeT"),i=r("2TvXO"),c=r("eBfQW"),u=r("bfaTO"),l=r("4s6iC"),v=r("twtVq"),p=r("kvC6y"),m=r("QXG35"),f=r("6Urw1"),b=r("3SEMc"),g=r("6Nu6u"),h=(0,f.initializeApp)({apiKey:"AIzaSyC4TFBFQRWUVazSJUXo0Z29XqKQGw3CwAA",authDomain:"filmoteka-29d04.firebaseapp.com",projectId:"filmoteka-29d04",storageBucket:"filmoteka-29d04.appspot.com",messagingSenderId:"839332022784",appId:"1:839332022784:web:20cca0e4887dab354326e5",measurementId:"G-8B53C0FEKF",databaseURL:"https://filmoteka-29d04-default-rtdb.europe-west1.firebasedatabase.app"}),k=(0,b.getAuth)(h),y=(0,g.getDatabase)(h),w={watchedBtn:document.querySelector(".js-watched-btn"),queueBtn:document.querySelector(".js-queue-btn"),gallery:document.querySelector(".js-gallery"),backdrop:document.querySelector(".backdrop"),modal:document.querySelector(".js-modal"),modalCloseBtn:document.querySelector(".js-modal-close"),addToWatchedBtn:document.querySelector(".js-add-to-watched-btn"),addToQueueBtn:document.querySelector(".js-add-to-queue-btn"),loginBtn:document.querySelector(".js-login-btn"),logoutBtn:document.querySelector(".js-logout-btn"),loginModal:document.querySelector(".js-login-modal"),loginModalCloseBtn:document.querySelector(".js-login-close"),loginForm:document.querySelector(".js-login-form")},E=[],x=new(0,p.Loader),q=function(e){e.target.classList.contains("backdrop")&&(B(),T())},L=function(e){"Escape"===e.code&&(B(),T())},B=function(){w.backdrop.classList.add("is-hidden"),setTimeout((function(){w.modal.classList.add("is-hidden")}),200),w.backdrop.removeEventListener("click",q),document.body.removeEventListener("keydown",L)},T=function(e){w.backdrop.classList.add("is-hidden"),setTimeout((function(){w.loginModal.classList.add("is-hidden")}),200),w.backdrop.removeEventListener("click",q),document.body.removeEventListener("keydown",L)},M=function(){0===E.length&&(0,m.showMessage)({type:"info",message:"There is no movies yet"});var e=(0,u.getMoviesMarkup)(E);w.gallery.innerHTML=e},U=function(e){var t,n=E.find((function(t){return t.id===Number(e)})),a=n.poster_path,r=n.title,s=n.vote_average,d=n.vote_count,i=n.popularity,c=n.original_title,u=n.genre_ids,p=n.overview,m=n.id;w.backdrop.querySelector(".js-img").src=a?"".concat(l.BASE_IMG).concat(a):"https://upload.wikimedia.org/wikipedia/commons/6/65/No-Image-Placeholder.svg",w.backdrop.querySelector(".js-title").textContent=r,w.backdrop.querySelector(".js-rating").textContent=s.toFixed(2),w.backdrop.querySelector(".js-votes").textContent=d,w.backdrop.querySelector(".js-popularity").textContent=i.toFixed(2),w.backdrop.querySelector(".js-original").textContent=c,w.backdrop.querySelector(".js-genre").textContent=0!==u.length?u.map((function(e){return v.default.find((function(t){return t.id===e})).name})).join(", "):"No information",w.backdrop.querySelector(".js-text").textContent=p,w.backdrop.querySelector(".js-modal").dataset.id=m,"watched"===(t=o)&&(w.addToQueueBtn.textContent="add to queue",w.addToWatchedBtn.textContent="remove"),"queue"===t&&(w.addToQueueBtn.textContent="remove",w.addToWatchedBtn.textContent="add to watched")},C=(s=e(d)(e(i).mark((function t(n){return e(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(w.watchedBtn.classList.add("active"),w.queueBtn.classList.remove("active"),"watched"!==o){e.next=4;break}return e.abrupt("return");case 4:return o="watched",x.show(),e.next=8,(0,c.readMovies)({database:y,key:l.WATCHED_KEY,uid:k.currentUser.uid});case 8:E=e.sent,x.hide(),M();case 11:case"end":return e.stop()}}),t)}))),function(e){return s.apply(this,arguments)}),S=function(){var t=e(d)(e(i).mark((function t(n){var a;return e(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(w.queueBtn.classList.add("active"),w.watchedBtn.classList.remove("active"),"queue"!==o){e.next=5;break}return e.abrupt("return");case 5:return o="queue",x.show(),e.next=9,(0,c.readMovies)({database:y,key:l.QUEUE_KEY,uid:null==k||null===(a=k.currentUser)||void 0===a?void 0:a.uid});case 9:E=e.sent,x.hide(),M();case 12:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),j=function(){var t=e(d)(e(i).mark((function t(n){var a,r;return e(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.currentTarget.closest(".js-modal").dataset.id,r=E.find((function(e){return e.id===Number(a)})),x.show(),"queue"!==o){e.next=12;break}return e.next=6,(0,c.createMovies)({database:y,key:l.WATCHED_KEY,uid:k.currentUser.uid,data:[r]});case 6:return e.next=8,(0,c.deleteMovie)({database:y,key:l.QUEUE_KEY,uid:k.currentUser.uid,idToDelete:a});case 8:return e.next=10,(0,c.readMovies)({database:y,key:l.QUEUE_KEY,uid:k.currentUser.uid});case 10:E=e.sent,(0,m.showMessage)({type:"success",message:"'".concat(r.title,"' is moved to 'Watched'")});case 12:if("watched"!==o){e.next=19;break}return e.next=15,(0,c.deleteMovie)({database:y,key:l.WATCHED_KEY,uid:k.currentUser.uid,idToDelete:a});case 15:return e.next=17,(0,c.readMovies)({database:y,key:l.WATCHED_KEY,uid:k.currentUser.uid});case 17:E=e.sent,(0,m.showMessage)({type:"success",message:"'".concat(r.title,"' is deleted")});case 19:x.hide(),B(),M();case 22:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),_=function(){var t=e(d)(e(i).mark((function t(n){var a,r;return e(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.currentTarget.closest(".js-modal").dataset.id,r=E.find((function(e){return e.id===Number(a)})),"watched"!==o){e.next=11;break}return e.next=5,(0,c.createMovies)({database:y,key:l.QUEUE_KEY,uid:k.currentUser.uid,data:[r]});case 5:return e.next=7,(0,c.deleteMovie)({database:y,key:l.WATCHED_KEY,uid:k.currentUser.uid,idToDelete:a});case 7:return e.next=9,(0,c.readMovies)({database:y,key:l.WATCHED_KEY,uid:k.currentUser.uid});case 9:E=e.sent,(0,m.showMessage)({type:"success",message:"'".concat(r.title,"' is moved to 'Queue'")});case 11:if("queue"!==o){e.next=18;break}return e.next=14,(0,c.deleteMovie)({database:y,key:l.QUEUE_KEY,uid:k.currentUser.uid,idToDelete:a});case 14:return e.next=16,(0,c.readMovies)({database:y,key:l.QUEUE_KEY,uid:k.currentUser.uid});case 16:E=e.sent,(0,m.showMessage)({type:"success",message:"'".concat(r.title,"' is deleted")});case 18:B(),M();case 20:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),A=function(){var t=e(d)(e(i).mark((function t(n){var a,r,o,s;return e(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),a=n.currentTarget.elements,r=a.email,o=a.password,s=a.method,console.log(s.value),"sign-up"!==s.value){e.next=8;break}return e.next=6,(0,b.createUserWithEmailAndPassword)(k,r.value,o.value).catch((function(e){console.log(e.code),console.log(e.message)}));case 6:e.next=11;break;case 8:if("sign-in"!==s.value){e.next=11;break}return e.next=11,(0,b.signInWithEmailAndPassword)(k,r.value,o.value).catch((function(e){console.log(e.code),console.log(e.message)}));case 11:T(),n.target.reset();case 13:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();(0,b.onAuthStateChanged)(k,(function(e){e?(w.loginBtn.classList.add("is-hidden"),w.logoutBtn.classList.remove("is-hidden"),w.watchedBtn.removeAttribute("disabled"),w.queueBtn.removeAttribute("disabled"),C()):(w.logoutBtn.classList.add("is-hidden"),w.loginBtn.classList.remove("is-hidden"),w.watchedBtn.setAttribute("disabled","true"),w.queueBtn.setAttribute("disabled","true"),w.gallery.innerHTML="",(0,m.showMessage)({type:"info",message:"You have to login to see movies in library"}))})),w.watchedBtn.addEventListener("click",C),w.queueBtn.addEventListener("click",S),w.gallery.addEventListener("click",(function(e){var t=e.target.closest("li").dataset.id;U(t),w.modal.classList.remove("is-hidden"),w.backdrop.classList.remove("is-hidden"),w.backdrop.addEventListener("click",q),document.body.addEventListener("keydown",L)})),w.modalCloseBtn.addEventListener("click",B),w.addToWatchedBtn.addEventListener("click",j),w.addToQueueBtn.addEventListener("click",_),w.loginBtn.addEventListener("click",(function(e){w.loginModal.classList.remove("is-hidden"),w.backdrop.classList.remove("is-hidden"),w.backdrop.addEventListener("click",q),document.body.addEventListener("keydown",L)})),w.logoutBtn.addEventListener("click",(function(e){k.signOut()})),w.loginModalCloseBtn.addEventListener("click",T),w.loginForm.addEventListener("submit",A)}();
//# sourceMappingURL=library.1ba52eac.js.map
