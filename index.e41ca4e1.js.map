{"mappings":"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","sources":["src/index.js","src/js/loader.js"],"sourcesContent":["import { getMoviesMarkup } from './js/templates';\nimport genres from './js/genres';\nimport { readMovies, createMovies, updateMovies } from './js/crud';\nimport { Loader } from './js/loader';\nimport { showMessage } from './js/showMessage';\n\nimport {\n  API_KEY,\n  BASE_URL,\n  BASE_IMG,\n  WATCHED_KEY,\n  QUEUE_KEY,\n} from './js/constants';\n\nconst refs = {\n  form: document.querySelector('form.header__form'),\n  gallery: document.querySelector('.movies-gallery'),\n  loadMoreBtn: document.querySelector('.js-load-more-btn'),\n  backdrop: document.querySelector('.backdrop'),\n  modal: document.querySelector('.js-modal'),\n  modalCloseBtn: document.querySelector('button.js-modal-close'),\n  watchedBtn: document.querySelector('.js-watched-btn'),\n  queueBtn: document.querySelector('.js-queue-btn'),\n  loginBtn: document.querySelector('.js-login-btn'),\n  loginModal: document.querySelector('.js-login-modal'),\n  loginModalCloseBtn: document.querySelector('.js-login-close'),\n};\n\nlet items = [];\nlet page = 1;\nlet query = '';\nlet currentResult = 0;\nlet totalResults = 0;\nlet searchByQuery = false;\nconst loader = new Loader();\n\nconst showButton = () => {\n  refs.loadMoreBtn.classList.remove('hidden');\n};\nconst hideButton = () => {\n  refs.loadMoreBtn.classList.add('hidden');\n};\n\nconst onBackdropClick = e => {\n  if (e.target.classList.contains('backdrop')) {\n    hideModal();\n    hideLogin();\n  }\n};\n\nconst onKeyPress = e => {\n  if (e.code === 'Escape') {\n    hideModal();\n    hideLogin();\n  }\n};\n\nconst showModal = () => {\n  refs.modal.classList.remove('is-hidden');\n  refs.backdrop.classList.remove('is-hidden');\n\n  refs.backdrop.addEventListener('click', onBackdropClick);\n  document.body.addEventListener('keydown', onKeyPress);\n};\nconst hideModal = () => {\n  refs.backdrop.classList.add('is-hidden');\n  setTimeout(() => {\n    refs.modal.classList.add('is-hidden');\n  }, 200);\n  refs.backdrop.removeEventListener('click', onBackdropClick);\n  document.body.removeEventListener('keydown', onKeyPress);\n};\n\nconst showLogin = e => {\n  refs.loginModal.classList.remove('is-hidden');\n  refs.backdrop.classList.remove('is-hidden');\n  refs.backdrop.addEventListener('click', onBackdropClick);\n  document.body.addEventListener('keydown', onKeyPress);\n};\n\nconst hideLogin = e => {\n  refs.backdrop.classList.add('is-hidden');\n  setTimeout(() => {\n    refs.loginModal.classList.add('is-hidden');\n  }, 200);\n  refs.backdrop.removeEventListener('click', onBackdropClick);\n  document.body.removeEventListener('keydown', onKeyPress);\n};\n\nconst reset = () => {\n  page = 1;\n  query = '';\n  currentResult = 0;\n  totalResults = 0;\n  items = [];\n  showButton();\n};\n\nconst loadTrendingMovies = async () => {\n  const res = await fetch(\n    `${BASE_URL}/trending/movie/week?api_key=${API_KEY}&page=${page}`\n  );\n  const data = await res.json();\n  currentResult += data.results.length;\n  totalResults = data.total_results;\n  if (currentResult === totalResults) {\n    hideButton();\n  }\n  items = [...items, ...data.results];\n};\n\nconst loadMoviesByQuery = async () => {\n  const res = await fetch(\n    `${BASE_URL}/search/movie?api_key=${API_KEY}&query=${query}&page=${page}`\n  );\n  const data = await res.json();\n  currentResult += data.results.length;\n  totalResults = data.total_results;\n  if (currentResult === totalResults) {\n    hideButton();\n  }\n  items = [...items, ...data.results];\n};\n\nconst renderItems = () => {\n  const markup = getMoviesMarkup(items);\n  refs.gallery.innerHTML = markup;\n};\n\nconst renderModal = idMovie => {\n  const {\n    poster_path,\n    title,\n    vote_average,\n    vote_count,\n    popularity,\n    original_title,\n    genre_ids,\n    overview,\n    id,\n  } = items.find(({ id }) => id === Number(idMovie));\n  refs.backdrop.querySelector('.js-img').src = poster_path\n    ? `${BASE_IMG}${poster_path}`\n    : 'https://upload.wikimedia.org/wikipedia/commons/6/65/No-Image-Placeholder.svg';\n  refs.backdrop.querySelector('.js-title').textContent = title;\n  refs.backdrop.querySelector('.js-rating').textContent =\n    vote_average.toFixed(2);\n  refs.backdrop.querySelector('.js-votes').textContent = vote_count;\n  refs.backdrop.querySelector('.js-popularity').textContent =\n    popularity.toFixed(2);\n  refs.backdrop.querySelector('.js-original').textContent = original_title;\n  refs.backdrop.querySelector('.js-genre').textContent =\n    genre_ids.length !== 0\n      ? genre_ids\n          .map(idGenre => genres.find(({ id }) => id === idGenre).name)\n          .join(', ')\n      : 'No information';\n  refs.backdrop.querySelector('.js-text').textContent = overview;\n  refs.backdrop.querySelector('.js-modal').dataset.id = id;\n};\n\nconst onFormSubmit = async e => {\n  e.preventDefault();\n  reset();\n  searchByQuery = true;\n  query = e.currentTarget.elements.query.value;\n  if (query) {\n    await onLoadMore();\n  }\n};\n\nconst onLoadMore = async () => {\n  loader.show();\n  if (searchByQuery) {\n    await loadMoviesByQuery();\n\n    page += 1;\n  } else {\n    page += 1;\n    await loadTrendingMovies();\n  }\n  loader.hide();\n  renderItems();\n};\n\nconst onGalleryClick = e => {\n  const element = e.target;\n  const id = element.closest('li').dataset.id;\n  renderModal(id);\n  showModal();\n};\n\nconst onWatchedBtnClick = e => {\n  const movieId = e.currentTarget.closest('.js-modal').dataset.id;\n  const movieData = items.find(({ id }) => id === Number(movieId));\n\n  const watchedMovies = readMovies(WATCHED_KEY);\n  const queueMovies = readMovies(QUEUE_KEY);\n  if (\n    watchedMovies?.find(({ id }) => id === Number(movieId)) ||\n    queueMovies?.find(({ id }) => id === Number(movieId))\n  ) {\n    showMessage({\n      type: 'failure',\n      message: `'${movieData.title}' has already been added to Library`,\n    });\n    hideModal();\n    return;\n  }\n  if (!watchedMovies) {\n    createMovies(WATCHED_KEY, movieData);\n    showMessage({\n      type: 'success',\n      message: `'${movieData.title}' is added to 'Watched'`,\n    });\n    hideModal();\n    return;\n  }\n\n  updateMovies(WATCHED_KEY, movieData);\n  showMessage({\n    type: 'success',\n    message: `'${movieData.title}' is added to 'Watched'`,\n  });\n  hideModal();\n};\n\nconst onQueueBtnClick = e => {\n  const movieId = e.currentTarget.closest('.js-modal').dataset.id;\n  const movieData = items.find(({ id }) => id === Number(movieId));\n\n  const queueMovies = readMovies(QUEUE_KEY);\n  const watchedMovies = readMovies(WATCHED_KEY);\n  if (\n    queueMovies?.find(({ id }) => id === Number(movieId)) ||\n    watchedMovies?.find(({ id }) => id === Number(movieId))\n  ) {\n    showMessage({\n      type: 'failure',\n      message: `'${movieData.title}' has already been added to Library`,\n    });\n    hideModal();\n    return;\n  }\n  if (!queueMovies) {\n    createMovies(QUEUE_KEY, movieData);\n    showMessage({\n      type: 'success',\n      message: `'${movieData.title}' is added to 'Queue'`,\n    });\n    hideModal();\n    return;\n  }\n\n  updateMovies(QUEUE_KEY, movieData);\n  showMessage({\n    type: 'success',\n    message: `'${movieData.title}' is added to 'Queue'`,\n  });\n  hideModal();\n};\n\nrefs.form.addEventListener('submit', onFormSubmit);\nrefs.loadMoreBtn.addEventListener('click', onLoadMore);\nrefs.gallery.addEventListener('click', onGalleryClick);\nrefs.modalCloseBtn.addEventListener('click', hideModal);\nrefs.watchedBtn.addEventListener('click', onWatchedBtnClick);\nrefs.queueBtn.addEventListener('click', onQueueBtnClick);\nrefs.loginBtn.addEventListener('click', showLogin);\nrefs.loginModalCloseBtn.addEventListener('click', hideLogin);\n\nloadTrendingMovies().then(renderItems);\n","import { Loading } from 'notiflix';\n\nexport class Loader {\n  constructor() {\n    Loading.init({\n      backgroundColor: 'rgba(0, 0, 0, 0.25)',\n      svgColor: '#ff6b01',\n    });\n  }\n  show() {\n    Loading.standard();\n  }\n  hide() {\n    Loading.remove();\n  }\n}\n"],"names":["$7sOwA","parcelRequire","$eWCmQ","$1f0dc3b9307be026$var$refs","form","document","querySelector","gallery","loadMoreBtn","backdrop","modal","modalCloseBtn","watchedBtn","queueBtn","loginBtn","loginModal","loginModalCloseBtn","$1f0dc3b9307be026$var$items","$1f0dc3b9307be026$var$page","$1f0dc3b9307be026$var$query","$1f0dc3b9307be026$var$currentResult","$1f0dc3b9307be026$var$totalResults","$1f0dc3b9307be026$var$searchByQuery","$1f0dc3b9307be026$var$loader","show","Loading","standard","hide","remove","constructor","init","backgroundColor","svgColor","$1f0dc3b9307be026$var$hideButton","classList","add","$1f0dc3b9307be026$var$onBackdropClick","e","target","contains","$1f0dc3b9307be026$var$hideModal","$1f0dc3b9307be026$var$hideLogin","$1f0dc3b9307be026$var$onKeyPress","code","setTimeout","removeEventListener","body","$1f0dc3b9307be026$var$reset","$1f0dc3b9307be026$var$loadTrendingMovies","async","res","fetch","$8G1wF","BASE_URL","API_KEY","data","json","results","length","total_results","$1f0dc3b9307be026$var$renderItems","markup","getMoviesMarkup","innerHTML","$1f0dc3b9307be026$var$onLoadMore","$1f0dc3b9307be026$var$loadMoviesByQuery","addEventListener","preventDefault","currentTarget","elements","query","value","idMovie","poster_path","title","vote_average","vote_count","popularity","original_title","genre_ids","overview","id","id1","find","Number","src","BASE_IMG","textContent","toFixed","map","idGenre","$ezyJp","default","name","join","dataset","$1f0dc3b9307be026$var$renderModal","closest","movieId","movieData","watchedMovies","$3nphs","readMovies","WATCHED_KEY","queueMovies","QUEUE_KEY","$2PXHr","showMessage","type","message","updateMovies","createMovies","then"],"version":3,"file":"index.e41ca4e1.js.map"}