{"mappings":"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","sources":["src/library.js"],"sourcesContent":["import { readMovies, deleteMovie, updateMovies } from './js/crud';\nimport { getMoviesMarkup } from './js/templates';\nimport { WATCHED_KEY, QUEUE_KEY, BASE_IMG } from './js/constants';\nimport genres from './js/genres';\nimport { showMessage } from './js/showMessage';\n\nconst refs = {\n  watchedBtn: document.querySelector('.js-watched-btn'),\n  queueBtn: document.querySelector('.js-queue-btn'),\n  gallery: document.querySelector('.js-gallery'),\n  backdrop: document.querySelector('.backdrop'),\n  closeBtn: document.querySelector('.js-modal-close'),\n  addToWatchedBtn: document.querySelector('.js-add-to-watched-btn'),\n  addToQueueBtn: document.querySelector('.js-add-to-queue-btn'),\n};\n\nlet items = [];\nlet currentPage = 'watched';\n\nconst onBackdropClick = e => {\n  if (e.target.classList.contains('backdrop')) {\n    hideModal();\n  }\n};\n\nconst onKeyPress = e => {\n  if (e.code === 'Escape') {\n    hideModal();\n  }\n};\n\nconst showModal = () => {\n  refs.backdrop.classList.remove('is-hidden');\n  refs.backdrop.addEventListener('click', onBackdropClick);\n  document.body.addEventListener('keydown', onKeyPress);\n};\nconst hideModal = () => {\n  refs.backdrop.classList.add('is-hidden');\n  refs.backdrop.removeEventListener('click', onBackdropClick);\n  document.body.removeEventListener('keydown', onKeyPress);\n};\nconst changeBtnView = page => {\n  if (page === 'watched') {\n    refs.addToQueueBtn.textContent = 'add to queue';\n    refs.addToWatchedBtn.textContent = 'remove';\n  }\n  if (page === 'queue') {\n    refs.addToQueueBtn.textContent = 'remove';\n    refs.addToWatchedBtn.textContent = 'add to watched';\n  }\n};\n\nconst renderItems = () => {\n  if (items.length === 0) {\n    showMessage({ type: 'info', message: 'There is no movies yet' });\n  }\n  const markup = getMoviesMarkup(items);\n  refs.gallery.innerHTML = markup;\n};\nconst renderModal = idMovie => {\n  const {\n    poster_path,\n    title,\n    vote_average,\n    vote_count,\n    popularity,\n    original_title,\n    genre_ids,\n    overview,\n    id,\n  } = items.find(({ id }) => id === Number(idMovie));\n  refs.backdrop.querySelector('.js-img').src = poster_path\n    ? `${BASE_IMG}${poster_path}`\n    : 'https://upload.wikimedia.org/wikipedia/commons/6/65/No-Image-Placeholder.svg';\n  refs.backdrop.querySelector('.js-title').textContent = title;\n  refs.backdrop.querySelector('.js-rating').textContent =\n    vote_average.toFixed(2);\n  refs.backdrop.querySelector('.js-votes').textContent = vote_count;\n  refs.backdrop.querySelector('.js-popularity').textContent =\n    popularity.toFixed(2);\n  refs.backdrop.querySelector('.js-original').textContent = original_title;\n  refs.backdrop.querySelector('.js-genre').textContent =\n    genre_ids.length !== 0\n      ? genre_ids\n          .map(idGenre => genres.find(({ id }) => id === idGenre).name)\n          .join(', ')\n      : 'No information';\n  refs.backdrop.querySelector('.js-text').textContent = overview;\n  refs.backdrop.querySelector('.js-modal').dataset.id = id;\n  changeBtnView(currentPage);\n};\n\nconst onWatchedBtnClick = e => {\n  refs.watchedBtn.classList.add('active');\n  refs.queueBtn.classList.remove('active');\n  currentPage = 'watched';\n  items = readMovies(WATCHED_KEY);\n  renderItems();\n};\nconst onQueueBtnClick = e => {\n  refs.queueBtn.classList.add('active');\n  refs.watchedBtn.classList.remove('active');\n  currentPage = 'queue';\n  items = readMovies(QUEUE_KEY);\n  renderItems();\n};\nconst onGalleryClick = e => {\n  const element = e.target;\n  const id = element.closest('li').dataset.id;\n  renderModal(id);\n  showModal();\n};\n\nconst onAddToWatchedBtnClick = e => {\n  const id = e.currentTarget.closest('.js-modal').dataset.id;\n  const movieData = items.find(({ id: movieId }) => movieId === Number(id));\n  if (currentPage === 'queue') {\n    updateMovies(WATCHED_KEY, movieData);\n    deleteMovie(QUEUE_KEY, id);\n    items = readMovies(QUEUE_KEY);\n    showMessage({\n      type: 'success',\n      message: `'${movieData.title}' is moved to 'Watched'`,\n    });\n  }\n  if (currentPage === 'watched') {\n    deleteMovie(WATCHED_KEY, id);\n    items = readMovies(WATCHED_KEY);\n    showMessage({\n      type: 'success',\n      message: `'${movieData.title}' is deleted`,\n    });\n  }\n  hideModal();\n\n  renderItems();\n};\n\nconst onAddToQueueBtn = e => {\n  const id = e.currentTarget.closest('.js-modal').dataset.id;\n  const movieData = items.find(({ id: movieId }) => movieId === Number(id));\n  if (currentPage === 'watched') {\n    updateMovies(QUEUE_KEY, movieData);\n    deleteMovie(WATCHED_KEY, id);\n    items = readMovies(WATCHED_KEY);\n    showMessage({\n      type: 'success',\n      message: `'${movieData.title}' is moved to 'Queue'`,\n    });\n  }\n  if (currentPage === 'queue') {\n    deleteMovie(QUEUE_KEY, id);\n    items = readMovies(QUEUE_KEY);\n    showMessage({\n      type: 'success',\n      message: `'${movieData.title}' is deleted`,\n    });\n  }\n  hideModal();\n\n  renderItems();\n};\n\nrefs.watchedBtn.addEventListener('click', onWatchedBtnClick);\nrefs.queueBtn.addEventListener('click', onQueueBtnClick);\nrefs.gallery.addEventListener('click', onGalleryClick);\nrefs.closeBtn.addEventListener('click', hideModal);\nrefs.addToWatchedBtn.addEventListener('click', onAddToWatchedBtnClick);\nrefs.addToQueueBtn.addEventListener('click', onAddToQueueBtn);\n\nonWatchedBtnClick();\n"],"names":["$3nphs","parcelRequire","$ce3726a01b8ab25a$var$refs","watchedBtn","document","querySelector","queueBtn","gallery","backdrop","closeBtn","addToWatchedBtn","addToQueueBtn","$ce3726a01b8ab25a$var$items","$ce3726a01b8ab25a$var$currentPage","$ce3726a01b8ab25a$var$onBackdropClick","e","target","classList","contains","$ce3726a01b8ab25a$var$hideModal","$ce3726a01b8ab25a$var$onKeyPress","code","add","removeEventListener","body","$ce3726a01b8ab25a$var$renderItems","length","$2PXHr","showMessage","type","message","markup","$7sOwA","getMoviesMarkup","innerHTML","$ce3726a01b8ab25a$var$renderModal","idMovie","poster_path","title","vote_average","vote_count","popularity","original_title","genre_ids","overview","id","id1","find","Number","page","src","$8G1wF","BASE_IMG","textContent","toFixed","map","idGenre","$ezyJp","default","name","join","dataset","$ce3726a01b8ab25a$var$onWatchedBtnClick","remove","readMovies","WATCHED_KEY","addEventListener","QUEUE_KEY","closest","currentTarget","movieData","movieId","updateMovies","deleteMovie"],"version":3,"file":"library.68c16bd9.js.map"}