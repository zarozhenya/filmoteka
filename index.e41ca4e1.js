var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},o={},d=e.parcelRequired7c6;null==d&&((d=function(e){if(e in t)return t[e].exports;if(e in o){var d=o[e];delete o[e];var s={id:e,exports:{}};return t[e]=s,d.call(s.exports,s,s.exports),s.exports}var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(e,t){o[e]=t},e.parcelRequired7c6=d);var s=d("7sOwA"),a=d("ezyJp"),r=d("3nphs"),n=d("eWCmQ");var i=d("2PXHr"),l=d("8G1wF");const c={form:document.querySelector("form.header__form"),gallery:document.querySelector(".movies-gallery"),loadMoreBtn:document.querySelector(".js-load-more-btn"),backdrop:document.querySelector(".backdrop"),modal:document.querySelector(".js-modal"),modalCloseBtn:document.querySelector("button.js-modal-close"),watchedBtn:document.querySelector(".js-watched-btn"),queueBtn:document.querySelector(".js-queue-btn"),loginBtn:document.querySelector(".js-login-btn"),loginModal:document.querySelector(".js-login-modal"),loginModalCloseBtn:document.querySelector(".js-login-close")};let u=[],m=1,v="",g=0,p=0,y=!1;const b=new class{show(){n.Loading.standard()}hide(){n.Loading.remove()}constructor(){n.Loading.init({backgroundColor:"rgba(0, 0, 0, 0.25)",svgColor:"#ff6b01"})}},E=()=>{c.loadMoreBtn.classList.add("hidden")},h=e=>{e.target.classList.contains("backdrop")&&(f(),L())},k=e=>{"Escape"===e.code&&(f(),L())},f=()=>{c.backdrop.classList.add("is-hidden"),setTimeout((()=>{c.modal.classList.add("is-hidden")}),200),c.backdrop.removeEventListener("click",h),document.body.removeEventListener("keydown",k)},L=e=>{c.backdrop.classList.add("is-hidden"),setTimeout((()=>{c.loginModal.classList.add("is-hidden")}),200),c.backdrop.removeEventListener("click",h),document.body.removeEventListener("keydown",k)},w=()=>{m=1,v="",g=0,p=0,u=[],c.loadMoreBtn.classList.remove("hidden")},M=async()=>{const e=await fetch(`${l.BASE_URL}/trending/movie/week?api_key=${l.API_KEY}&page=${m}`),t=await e.json();g+=t.results.length,p=t.total_results,g===p&&E(),u=[...u,...t.results]},q=()=>{const e=(0,s.getMoviesMarkup)(u);c.gallery.innerHTML=e},_=async()=>{b.show(),y?(await(async()=>{const e=await fetch(`${l.BASE_URL}/search/movie?api_key=${l.API_KEY}&query=${v}&page=${m}`),t=await e.json();g+=t.results.length,p=t.total_results,g===p&&E(),u=[...u,...t.results]})(),m+=1):(m+=1,await M()),b.hide(),q()};c.form.addEventListener("submit",(async e=>{e.preventDefault(),w(),y=!0,v=e.currentTarget.elements.query.value,v&&await _()})),c.loadMoreBtn.addEventListener("click",_),c.gallery.addEventListener("click",(e=>{(e=>{const{poster_path:t,title:o,vote_average:d,vote_count:s,popularity:r,original_title:n,genre_ids:i,overview:m,id:v}=u.find((({id:t})=>t===Number(e)));c.backdrop.querySelector(".js-img").src=t?`${l.BASE_IMG}${t}`:"https://upload.wikimedia.org/wikipedia/commons/6/65/No-Image-Placeholder.svg",c.backdrop.querySelector(".js-title").textContent=o,c.backdrop.querySelector(".js-rating").textContent=d.toFixed(2),c.backdrop.querySelector(".js-votes").textContent=s,c.backdrop.querySelector(".js-popularity").textContent=r.toFixed(2),c.backdrop.querySelector(".js-original").textContent=n,c.backdrop.querySelector(".js-genre").textContent=0!==i.length?i.map((e=>a.default.find((({id:t})=>t===e)).name)).join(", "):"No information",c.backdrop.querySelector(".js-text").textContent=m,c.backdrop.querySelector(".js-modal").dataset.id=v})(e.target.closest("li").dataset.id),c.modal.classList.remove("is-hidden"),c.backdrop.classList.remove("is-hidden"),c.backdrop.addEventListener("click",h),document.body.addEventListener("keydown",k)})),c.modalCloseBtn.addEventListener("click",f),c.watchedBtn.addEventListener("click",(e=>{const t=e.currentTarget.closest(".js-modal").dataset.id,o=u.find((({id:e})=>e===Number(t))),d=(0,r.readMovies)(l.WATCHED_KEY),s=(0,r.readMovies)(l.QUEUE_KEY);return(null==d?void 0:d.find((({id:e})=>e===Number(t))))||(null==s?void 0:s.find((({id:e})=>e===Number(t))))?((0,i.showMessage)({type:"failure",message:`'${o.title}' has already been added to Library`}),void f()):d?((0,r.updateMovies)(l.WATCHED_KEY,o),(0,i.showMessage)({type:"success",message:`'${o.title}' is added to 'Watched'`}),void f()):((0,r.createMovies)(l.WATCHED_KEY,o),(0,i.showMessage)({type:"success",message:`'${o.title}' is added to 'Watched'`}),void f())})),c.queueBtn.addEventListener("click",(e=>{const t=e.currentTarget.closest(".js-modal").dataset.id,o=u.find((({id:e})=>e===Number(t))),d=(0,r.readMovies)(l.QUEUE_KEY),s=(0,r.readMovies)(l.WATCHED_KEY);return(null==d?void 0:d.find((({id:e})=>e===Number(t))))||(null==s?void 0:s.find((({id:e})=>e===Number(t))))?((0,i.showMessage)({type:"failure",message:`'${o.title}' has already been added to Library`}),void f()):d?((0,r.updateMovies)(l.QUEUE_KEY,o),(0,i.showMessage)({type:"success",message:`'${o.title}' is added to 'Queue'`}),void f()):((0,r.createMovies)(l.QUEUE_KEY,o),(0,i.showMessage)({type:"success",message:`'${o.title}' is added to 'Queue'`}),void f())})),c.loginBtn.addEventListener("click",(e=>{c.loginModal.classList.remove("is-hidden"),c.backdrop.classList.remove("is-hidden"),c.backdrop.addEventListener("click",h),document.body.addEventListener("keydown",k)})),c.loginModalCloseBtn.addEventListener("click",L),M().then(q);
//# sourceMappingURL=index.e41ca4e1.js.map
