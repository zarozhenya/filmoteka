var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},o={},r=e.parcelRequired7c6;null==r&&((r=function(e){if(e in t)return t[e].exports;if(e in o){var r=o[e];delete o[e];var s={id:e,exports:{}};return t[e]=s,r.call(s.exports,s,s.exports),s.exports}var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(e,t){o[e]=t},e.parcelRequired7c6=r);var s=r("7sOwA"),a=r("ezyJp"),d=r("3nphs"),i=r("eWCmQ");var n=r("2PXHr"),l=r("8G1wF");const c={form:document.querySelector("form.header__form"),gallery:document.querySelector(".movies-gallery"),loadMoreBtn:document.querySelector(".js-load-more-btn"),backdrop:document.querySelector(".backdrop"),modalCloseBtn:document.querySelector("button.js-modal-close"),watchedBtn:document.querySelector(".js-watched-btn"),queueBtn:document.querySelector(".js-queue-btn")};let u=[],p=1,m="",g=0,y=0,v=!1;const f=new class{show(){i.Loading.standard()}hide(){i.Loading.remove()}constructor(){i.Loading.init({backgroundColor:"rgba(0, 0, 0, 0.25)",svgColor:"#ff6b01"})}},b=()=>{c.loadMoreBtn.classList.add("hidden")},h=()=>{p=1,m="",g=0,y=0,u=[],c.loadMoreBtn.classList.remove("hidden")},E=async()=>{const e=await fetch(`${l.BASE_URL}/trending/movie/week?api_key=${l.API_KEY}&page=${p}`),t=await e.json();g+=t.results.length,y=t.total_results,g===y&&b(),u=[...u,...t.results]},w=()=>{const e=(0,s.getMoviesMarkup)(u);c.gallery.innerHTML=e},_=async()=>{f.show(),v?(await(async()=>{const e=await fetch(`${l.BASE_URL}/search/movie?api_key=${l.API_KEY}&query=${m}&page=${p}`),t=await e.json();g+=t.results.length,y=t.total_results,g===y&&b(),u=[...u,...t.results]})(),p+=1):(p+=1,await E()),f.hide(),w()};c.form.addEventListener("submit",(async e=>{e.preventDefault(),h(),v=!0,m=e.currentTarget.elements.query.value,m&&await _()})),c.loadMoreBtn.addEventListener("click",_),c.gallery.addEventListener("click",(e=>{(e=>{const{poster_path:t,title:o,vote_average:r,vote_count:s,popularity:d,original_title:i,genre_ids:n,overview:p,id:m}=u.find((({id:t})=>t===Number(e)));c.backdrop.querySelector(".js-img").src=t?`${l.BASE_IMG}${t}`:"https://upload.wikimedia.org/wikipedia/commons/6/65/No-Image-Placeholder.svg",c.backdrop.querySelector(".js-title").textContent=o,c.backdrop.querySelector(".js-rating").textContent=r.toFixed(2),c.backdrop.querySelector(".js-votes").textContent=s,c.backdrop.querySelector(".js-popularity").textContent=d.toFixed(2),c.backdrop.querySelector(".js-original").textContent=i,c.backdrop.querySelector(".js-genre").textContent=0!==n.length?n.map((e=>a.default.find((({id:t})=>t===e)).name)).join(", "):"No information",c.backdrop.querySelector(".js-text").textContent=p,c.backdrop.querySelector(".js-modal").dataset.id=m})(e.target.closest("li").dataset.id),c.backdrop.classList.remove("is-hidden")})),c.modalCloseBtn.addEventListener("click",(()=>{c.backdrop.classList.add("is-hidden")})),c.watchedBtn.addEventListener("click",(e=>{const t=e.currentTarget.closest(".js-modal").dataset.id,o=u.find((({id:e})=>e===Number(t))),r=(0,d.readMovies)(l.WATCHED_KEY),s=(0,d.readMovies)(l.QUEUE_KEY);if((null==r?void 0:r.find((({id:e})=>e===Number(t))))||(null==s?void 0:s.find((({id:e})=>e===Number(t)))))(0,n.showMessage)({type:"failure",message:`'${o.title}' has already been added to Library`});else{if(!r)return(0,d.createMovies)(l.WATCHED_KEY,o),void(0,n.showMessage)({type:"success",message:`'${o.title}' is added to 'Watched'`});(0,d.updateMovies)(l.WATCHED_KEY,o),(0,n.showMessage)({type:"success",message:`'${o.title}' is added to 'Watched'`})}})),c.queueBtn.addEventListener("click",(e=>{const t=e.currentTarget.closest(".js-modal").dataset.id,o=u.find((({id:e})=>e===Number(t))),r=(0,d.readMovies)(l.QUEUE_KEY),s=(0,d.readMovies)(l.WATCHED_KEY);if((null==r?void 0:r.find((({id:e})=>e===Number(t))))||(null==s?void 0:s.find((({id:e})=>e===Number(t)))))(0,n.showMessage)({type:"failure",message:`'${o.title}' has already been added to Library`});else{if(!r)return(0,d.createMovies)(l.QUEUE_KEY,o),void(0,n.showMessage)({type:"success",message:`'${o.title}' is added to 'Queue'`});(0,d.updateMovies)(l.QUEUE_KEY,o),(0,n.showMessage)({type:"success",message:`'${o.title}' is added to 'Queue'`})}})),E().then(w);
//# sourceMappingURL=index.f6e08d52.js.map
