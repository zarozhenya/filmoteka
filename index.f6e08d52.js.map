{"mappings":"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","sources":["src/index.js","src/js/loader.js"],"sourcesContent":["import { getMoviesMarkup } from './js/templates';\nimport genres from './js/genres';\nimport { readMovies, createMovies, updateMovies } from './js/crud';\nimport { Loader } from './js/loader';\nimport { showMessage } from './js/showMessage';\n\nimport {\n  API_KEY,\n  BASE_URL,\n  BASE_IMG,\n  WATCHED_KEY,\n  QUEUE_KEY,\n} from './js/constants';\n\nconst refs = {\n  form: document.querySelector('form.header__form'),\n  gallery: document.querySelector('.movies-gallery'),\n  loadMoreBtn: document.querySelector('.js-load-more-btn'),\n  backdrop: document.querySelector('.backdrop'),\n  modalCloseBtn: document.querySelector('button.js-modal-close'),\n  watchedBtn: document.querySelector('.js-watched-btn'),\n  queueBtn: document.querySelector('.js-queue-btn'),\n};\n\nlet items = [];\nlet page = 1;\nlet query = '';\nlet currentResult = 0;\nlet totalResults = 0;\nlet searchByQuery = false;\nconst loader = new Loader();\n\nconst showButton = () => {\n  refs.loadMoreBtn.classList.remove('hidden');\n};\nconst hideButton = () => {\n  refs.loadMoreBtn.classList.add('hidden');\n};\n\nconst showModal = () => {\n  refs.backdrop.classList.remove('is-hidden');\n};\nconst hideModal = () => {\n  refs.backdrop.classList.add('is-hidden');\n};\n\nconst reset = () => {\n  page = 1;\n  query = '';\n  currentResult = 0;\n  totalResults = 0;\n  items = [];\n  showButton();\n};\n\nconst loadTrendingMovies = async () => {\n  const res = await fetch(\n    `${BASE_URL}/trending/movie/week?api_key=${API_KEY}&page=${page}`\n  );\n  const data = await res.json();\n  currentResult += data.results.length;\n  totalResults = data.total_results;\n  if (currentResult === totalResults) {\n    hideButton();\n  }\n  items = [...items, ...data.results];\n};\n\nconst loadMoviesByQuery = async () => {\n  const res = await fetch(\n    `${BASE_URL}/search/movie?api_key=${API_KEY}&query=${query}&page=${page}`\n  );\n  const data = await res.json();\n  currentResult += data.results.length;\n  totalResults = data.total_results;\n  if (currentResult === totalResults) {\n    hideButton();\n  }\n  items = [...items, ...data.results];\n};\n\nconst renderItems = () => {\n  const markup = getMoviesMarkup(items);\n  refs.gallery.innerHTML = markup;\n};\n\nconst renderModal = idMovie => {\n  const {\n    poster_path,\n    title,\n    vote_average,\n    vote_count,\n    popularity,\n    original_title,\n    genre_ids,\n    overview,\n    id,\n  } = items.find(({ id }) => id === Number(idMovie));\n  refs.backdrop.querySelector('.js-img').src = poster_path\n    ? `${BASE_IMG}${poster_path}`\n    : 'https://upload.wikimedia.org/wikipedia/commons/6/65/No-Image-Placeholder.svg';\n  refs.backdrop.querySelector('.js-title').textContent = title;\n  refs.backdrop.querySelector('.js-rating').textContent =\n    vote_average.toFixed(2);\n  refs.backdrop.querySelector('.js-votes').textContent = vote_count;\n  refs.backdrop.querySelector('.js-popularity').textContent =\n    popularity.toFixed(2);\n  refs.backdrop.querySelector('.js-original').textContent = original_title;\n  refs.backdrop.querySelector('.js-genre').textContent =\n    genre_ids.length !== 0\n      ? genre_ids\n          .map(idGenre => genres.find(({ id }) => id === idGenre).name)\n          .join(', ')\n      : 'No information';\n  refs.backdrop.querySelector('.js-text').textContent = overview;\n  refs.backdrop.querySelector('.js-modal').dataset.id = id;\n};\n\nconst onFormSubmit = async e => {\n  e.preventDefault();\n  reset();\n  searchByQuery = true;\n  query = e.currentTarget.elements.query.value;\n  if (query) {\n    await onLoadMore();\n  }\n};\n\nconst onLoadMore = async () => {\n  loader.show();\n  if (searchByQuery) {\n    await loadMoviesByQuery();\n\n    page += 1;\n  } else {\n    page += 1;\n    await loadTrendingMovies();\n  }\n  loader.hide();\n  renderItems();\n};\n\nconst onGalleryClick = e => {\n  const element = e.target;\n  const id = element.closest('li').dataset.id;\n  renderModal(id);\n  showModal();\n};\n\nconst onWatchedBtnClick = e => {\n  const movieId = e.currentTarget.closest('.js-modal').dataset.id;\n  const movieData = items.find(({ id }) => id === Number(movieId));\n\n  const watchedMovies = readMovies(WATCHED_KEY);\n  const queueMovies = readMovies(QUEUE_KEY);\n  if (\n    watchedMovies?.find(({ id }) => id === Number(movieId)) ||\n    queueMovies?.find(({ id }) => id === Number(movieId))\n  ) {\n    showMessage({\n      type: 'failure',\n      message: `'${movieData.title}' has already been added to Library`,\n    });\n    return;\n  }\n  if (!watchedMovies) {\n    createMovies(WATCHED_KEY, movieData);\n    showMessage({\n      type: 'success',\n      message: `'${movieData.title}' is added to 'Watched'`,\n    });\n    return;\n  }\n\n  updateMovies(WATCHED_KEY, movieData);\n  showMessage({\n    type: 'success',\n    message: `'${movieData.title}' is added to 'Watched'`,\n  });\n};\n\nconst onQueueBtnClick = e => {\n  const movieId = e.currentTarget.closest('.js-modal').dataset.id;\n  const movieData = items.find(({ id }) => id === Number(movieId));\n\n  const queueMovies = readMovies(QUEUE_KEY);\n  const watchedMovies = readMovies(WATCHED_KEY);\n  if (\n    queueMovies?.find(({ id }) => id === Number(movieId)) ||\n    watchedMovies?.find(({ id }) => id === Number(movieId))\n  ) {\n    showMessage({\n      type: 'failure',\n      message: `'${movieData.title}' has already been added to Library`,\n    });\n    return;\n  }\n  if (!queueMovies) {\n    createMovies(QUEUE_KEY, movieData);\n    showMessage({\n      type: 'success',\n      message: `'${movieData.title}' is added to 'Queue'`,\n    });\n    return;\n  }\n\n  updateMovies(QUEUE_KEY, movieData);\n  showMessage({\n    type: 'success',\n    message: `'${movieData.title}' is added to 'Queue'`,\n  });\n};\n\nrefs.form.addEventListener('submit', onFormSubmit);\nrefs.loadMoreBtn.addEventListener('click', onLoadMore);\nrefs.gallery.addEventListener('click', onGalleryClick);\nrefs.modalCloseBtn.addEventListener('click', hideModal);\nrefs.watchedBtn.addEventListener('click', onWatchedBtnClick);\nrefs.queueBtn.addEventListener('click', onQueueBtnClick);\n\nloadTrendingMovies().then(renderItems);\n","import { Loading } from 'notiflix';\n\nexport class Loader {\n  constructor() {\n    Loading.init({\n      backgroundColor: 'rgba(0, 0, 0, 0.25)',\n      svgColor: '#ff6b01',\n    });\n  }\n  show() {\n    Loading.standard();\n  }\n  hide() {\n    Loading.remove();\n  }\n}\n"],"names":["$7sOwA","parcelRequire","$eWCmQ","$1f0dc3b9307be026$var$refs","form","document","querySelector","gallery","loadMoreBtn","backdrop","modalCloseBtn","watchedBtn","queueBtn","$1f0dc3b9307be026$var$items","$1f0dc3b9307be026$var$page","$1f0dc3b9307be026$var$query","$1f0dc3b9307be026$var$currentResult","$1f0dc3b9307be026$var$totalResults","$1f0dc3b9307be026$var$searchByQuery","$1f0dc3b9307be026$var$loader","show","Loading","standard","hide","remove","constructor","init","backgroundColor","svgColor","$1f0dc3b9307be026$var$hideButton","classList","add","$1f0dc3b9307be026$var$reset","$1f0dc3b9307be026$var$loadTrendingMovies","async","res","fetch","$8G1wF","BASE_URL","API_KEY","data","json","results","length","total_results","$1f0dc3b9307be026$var$renderItems","markup","getMoviesMarkup","innerHTML","$1f0dc3b9307be026$var$onLoadMore","$1f0dc3b9307be026$var$loadMoviesByQuery","addEventListener","e","preventDefault","currentTarget","elements","query","value","idMovie","poster_path","title","vote_average","vote_count","popularity","original_title","genre_ids","overview","id","id1","find","Number","src","BASE_IMG","textContent","toFixed","map","idGenre","$ezyJp","default","name","join","dataset","$1f0dc3b9307be026$var$renderModal","target","closest","movieId","movieData","watchedMovies","$3nphs","readMovies","WATCHED_KEY","queueMovies","QUEUE_KEY","$2PXHr","showMessage","type","message","createMovies","updateMovies","then"],"version":3,"file":"index.f6e08d52.js.map"}