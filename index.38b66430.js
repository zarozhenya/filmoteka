var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},a={},d=e.parcelRequired7c6;null==d&&((d=function(e){if(e in t)return t[e].exports;if(e in a){var d=a[e];delete a[e];var o={id:e,exports:{}};return t[e]=o,d.call(o.exports,o,o.exports),o.exports}var s=new Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}).register=function(e,t){a[e]=t},e.parcelRequired7c6=d);var o=d("7sOwA"),s=d("ezyJp"),i=d("3nphs"),n=d("gjiCh"),r=d("2PXHr"),l=d("8G1wF"),c=d("25RCP"),u=d("amyG6"),m=d("fQ3Fn");const g=(0,c.initializeApp)({apiKey:"AIzaSyC4TFBFQRWUVazSJUXo0Z29XqKQGw3CwAA",authDomain:"filmoteka-29d04.firebaseapp.com",projectId:"filmoteka-29d04",storageBucket:"filmoteka-29d04.appspot.com",messagingSenderId:"839332022784",appId:"1:839332022784:web:20cca0e4887dab354326e5",measurementId:"G-8B53C0FEKF",databaseURL:"https://filmoteka-29d04-default-rtdb.europe-west1.firebasedatabase.app"}),y=(0,u.getAuth)(g),p=(0,m.getDatabase)(g),v={form:document.querySelector("form.header__form"),gallery:document.querySelector(".movies-gallery"),loadMoreBtn:document.querySelector(".js-load-more-btn"),backdrop:document.querySelector(".backdrop"),modal:document.querySelector(".js-modal"),modalCloseBtn:document.querySelector("button.js-modal-close"),watchedBtn:document.querySelector(".js-watched-btn"),queueBtn:document.querySelector(".js-queue-btn"),loginBtn:document.querySelector(".js-login-btn"),logoutBtn:document.querySelector(".js-logout-btn"),loginModal:document.querySelector(".js-login-modal"),loginModalCloseBtn:document.querySelector(".js-login-close"),loginForm:document.querySelector(".js-login-form"),libraryLink:document.querySelector(".js-library-item")};let h=[],b=1,k="",w=0,f=0,L=!1;const E=new(0,n.Loader),q=()=>{v.loadMoreBtn.classList.add("hidden")},B=e=>{e.target.classList.contains("backdrop")&&(j(),M())},S=e=>{"Escape"===e.code&&(j(),M())},j=()=>{v.backdrop.classList.add("is-hidden"),setTimeout((()=>{v.modal.classList.add("is-hidden")}),200),v.backdrop.removeEventListener("click",B),document.body.removeEventListener("keydown",S)},M=e=>{v.backdrop.classList.add("is-hidden"),setTimeout((()=>{v.loginModal.classList.add("is-hidden")}),200),v.backdrop.removeEventListener("click",B),document.body.removeEventListener("keydown",S)},_=()=>{b=1,k="",w=0,f=0,h=[],v.loadMoreBtn.classList.remove("hidden")},C=async()=>{E.show();const e=await fetch(`${l.BASE_URL}/trending/movie/day?api_key=${l.API_KEY}&page=${b}`),t=await e.json();w+=t.results.length,f=t.total_results,w===f&&q(),h=[...h,...t.results],E.hide()},U=()=>{const e=(0,o.getMoviesMarkup)(h);v.gallery.innerHTML=e},A=async()=>{L?(await(async()=>{E.show();const e=await fetch(`${l.BASE_URL}/search/movie?api_key=${l.API_KEY}&query=${k}&page=${b}`),t=await e.json();w+=t.results.length,f=t.total_results,w===f&&q(),h=[...h,...t.results],E.hide()})(),b+=1):(b+=1,await C()),U()};(0,u.onAuthStateChanged)(y,(e=>{e?(v.loginBtn.classList.add("is-hidden"),v.logoutBtn.classList.remove("is-hidden"),v.queueBtn.classList.remove("is-hidden"),v.watchedBtn.classList.remove("is-hidden")):(v.logoutBtn.classList.add("is-hidden"),v.loginBtn.classList.remove("is-hidden"),v.queueBtn.classList.add("is-hidden"),v.watchedBtn.classList.add("is-hidden"))})),v.form.addEventListener("submit",(async e=>{e.preventDefault(),_(),L=!0,k=e.currentTarget.elements.query.value,k&&await A()})),v.loadMoreBtn.addEventListener("click",A),v.gallery.addEventListener("click",(e=>{(e=>{const{poster_path:t,title:a,vote_average:d,vote_count:o,popularity:i,original_title:n,genre_ids:r,overview:c,id:u}=h.find((({id:t})=>t===Number(e)));v.backdrop.querySelector(".js-img").src=t?`${l.BASE_IMG}${t}`:"https://upload.wikimedia.org/wikipedia/commons/6/65/No-Image-Placeholder.svg",v.backdrop.querySelector(".js-title").textContent=a,v.backdrop.querySelector(".js-rating").textContent=d.toFixed(2),v.backdrop.querySelector(".js-votes").textContent=o,v.backdrop.querySelector(".js-popularity").textContent=i.toFixed(2),v.backdrop.querySelector(".js-original").textContent=n,v.backdrop.querySelector(".js-genre").textContent=0!==r.length?r.map((e=>s.default.find((({id:t})=>t===e)).name)).join(", "):"No information",v.backdrop.querySelector(".js-text").textContent=c,v.backdrop.querySelector(".js-modal").dataset.id=u})(e.target.closest("li").dataset.id),v.modal.classList.remove("is-hidden"),v.backdrop.classList.remove("is-hidden"),v.backdrop.addEventListener("click",B),document.body.addEventListener("keydown",S)})),v.modalCloseBtn.addEventListener("click",j),v.watchedBtn.addEventListener("click",(async e=>{const t=e.currentTarget.closest(".js-modal").dataset.id,a=h.find((({id:e})=>e===Number(t)));E.show();const d=await(0,i.readMovies)({database:p,key:l.WATCHED_KEY,uid:y.currentUser.uid}),o=await(0,i.readMovies)({database:p,key:l.QUEUE_KEY,uid:y.currentUser.uid});if((null==d?void 0:d.find((({id:e})=>e===Number(t))))||(null==o?void 0:o.find((({id:e})=>e===Number(t)))))return(0,r.showMessage)({type:"failure",message:`'${a.title}' has already been added to Library`}),E.hide(),void j();await(0,i.createMovies)({database:p,key:l.WATCHED_KEY,uid:y.currentUser.uid,data:[a]}),E.hide(),(0,r.showMessage)({type:"success",message:`'${a.title}' is added to 'Watched'`}),j()})),v.queueBtn.addEventListener("click",(async e=>{const t=e.currentTarget.closest(".js-modal").dataset.id,a=h.find((({id:e})=>e===Number(t)));E.show();const d=await(0,i.readMovies)({database:p,key:l.WATCHED_KEY,uid:y.currentUser.uid}),o=await(0,i.readMovies)({database:p,key:l.QUEUE_KEY,uid:y.currentUser.uid});if((null==d?void 0:d.find((({id:e})=>e===Number(t))))||(null==o?void 0:o.find((({id:e})=>e===Number(t)))))return(0,r.showMessage)({type:"failure",message:`'${a.title}' has already been added to Library`}),E.hide(),void j();await(0,i.createMovies)({database:p,key:l.QUEUE_KEY,uid:y.currentUser.uid,data:[a]}),E.hide(),(0,r.showMessage)({type:"success",message:`'${a.title}' is added to 'Queue'`}),j()})),v.loginBtn.addEventListener("click",(e=>{v.loginModal.classList.remove("is-hidden"),v.backdrop.classList.remove("is-hidden"),v.backdrop.addEventListener("click",B),document.body.addEventListener("keydown",S)})),v.logoutBtn.addEventListener("click",(e=>{y.signOut()})),v.loginModalCloseBtn.addEventListener("click",M),v.loginForm.addEventListener("submit",(async e=>{e.preventDefault();const{email:t,password:a,method:d}=e.currentTarget.elements;console.log(d.value),"sign-up"===d.value?await(0,u.createUserWithEmailAndPassword)(y,t.value,a.value).catch((e=>{console.log(e.code),console.log(e.message)})):"sign-in"===d.value&&await(0,u.signInWithEmailAndPassword)(y,t.value,a.value).catch((e=>{console.log(e.code),console.log(e.message)})),M(),e.target.reset()})),C().then(U);
//# sourceMappingURL=index.38b66430.js.map
