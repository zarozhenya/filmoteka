!function(){function e(e){return e&&e.__esModule?e.default:e}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n={},r={},a=t.parcelRequired7c6;null==a&&((a=function(e){if(e in n)return n[e].exports;if(e in r){var t=r[e];delete r[e];var a={id:e,exports:{}};return n[e]=a,t.call(a.exports,a,a.exports),a.exports}var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(e,t){r[e]=t},t.parcelRequired7c6=a);var o,s=a("bpxeT"),i=a("8nrFW"),c=a("2TvXO"),d=a("bfaTO"),u=a("twtVq"),l=a("eBfQW"),f=a("kvC6y"),p=a("QXG35"),m=a("4s6iC"),v=a("6Urw1"),g=a("3SEMc"),h=a("6Nu6u"),b=(0,v.initializeApp)({apiKey:"AIzaSyC4TFBFQRWUVazSJUXo0Z29XqKQGw3CwAA",authDomain:"filmoteka-29d04.firebaseapp.com",projectId:"filmoteka-29d04",storageBucket:"filmoteka-29d04.appspot.com",messagingSenderId:"839332022784",appId:"1:839332022784:web:20cca0e4887dab354326e5",measurementId:"G-8B53C0FEKF",databaseURL:"https://filmoteka-29d04-default-rtdb.europe-west1.firebasedatabase.app"}),y=(0,g.getAuth)(b),k=(0,h.getDatabase)(b),w={form:document.querySelector("form.header__form"),gallery:document.querySelector(".movies-gallery"),loadMoreBtn:document.querySelector(".js-load-more-btn"),backdrop:document.querySelector(".backdrop"),modal:document.querySelector(".js-modal"),modalCloseBtn:document.querySelector("button.js-modal-close"),watchedBtn:document.querySelector(".js-watched-btn"),queueBtn:document.querySelector(".js-queue-btn"),loginBtn:document.querySelector(".js-login-btn"),logoutBtn:document.querySelector(".js-logout-btn"),loginModal:document.querySelector(".js-login-modal"),loginModalCloseBtn:document.querySelector(".js-login-close"),loginForm:document.querySelector(".js-login-form"),libraryLink:document.querySelector(".js-library-item")},x=[],L=1,E="",q=0,B=0,S=!1,j=new(0,f.Loader),M=function(){w.loadMoreBtn.classList.add("hidden")},_=function(e){e.target.classList.contains("backdrop")&&(U(),T())},C=function(e){"Escape"===e.code&&(U(),T())},U=function(){w.backdrop.classList.add("is-hidden"),setTimeout((function(){w.modal.classList.add("is-hidden")}),200),w.backdrop.removeEventListener("click",_),document.body.removeEventListener("keydown",C)},T=function(e){w.backdrop.classList.add("is-hidden"),setTimeout((function(){w.loginModal.classList.add("is-hidden")}),200),w.backdrop.removeEventListener("click",_),document.body.removeEventListener("keydown",C)},A=function(){L=1,E="",q=0,B=0,x=[],w.loadMoreBtn.classList.remove("hidden")},N=(o=e(s)(e(c).mark((function t(){var n,r;return e(c).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return j.show(),t.next=3,fetch("".concat(m.BASE_URL,"/trending/movie/day?api_key=").concat(m.API_KEY,"&page=").concat(L));case 3:return n=t.sent,t.next=6,n.json();case 6:r=t.sent,q+=r.results.length,B=r.total_results,q===B&&M(),x=e(i)(x).concat(e(i)(r.results)),j.hide();case 12:case"end":return t.stop()}}),t)}))),function(){return o.apply(this,arguments)}),K=function(){var t=e(s)(e(c).mark((function t(){var n,r;return e(c).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return j.show(),t.next=3,fetch("".concat(m.BASE_URL,"/search/movie?api_key=").concat(m.API_KEY,"&query=").concat(E,"&page=").concat(L));case 3:return n=t.sent,t.next=6,n.json();case 6:r=t.sent,q+=r.results.length,B=r.total_results,q===B&&M(),x=e(i)(x).concat(e(i)(r.results)),j.hide();case 12:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),F=function(){var e=(0,d.getMoviesMarkup)(x);w.gallery.innerHTML=e},I=function(){var t=e(s)(e(c).mark((function t(n){return e(c).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),A(),S=!0,!(E=n.currentTarget.elements.query.value)){e.next=7;break}return e.next=7,D();case 7:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),D=function(){var t=e(s)(e(c).mark((function t(){return e(c).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!S){e.next=6;break}return e.next=3,K();case 3:L+=1,e.next=9;break;case 6:return L+=1,e.next=9,N();case 9:F();case 10:case"end":return e.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),W=function(){var t=e(s)(e(c).mark((function t(n){var r,a,o,s;return e(c).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.currentTarget.closest(".js-modal").dataset.id,a=x.find((function(e){return e.id===Number(r)})),j.show(),e.next=5,(0,l.readMovies)({database:k,key:m.WATCHED_KEY,uid:y.currentUser.uid});case 5:return o=e.sent,e.next=8,(0,l.readMovies)({database:k,key:m.QUEUE_KEY,uid:y.currentUser.uid});case 8:if(s=e.sent,!(null==o?void 0:o.find((function(e){return e.id===Number(r)})))&&!(null==s?void 0:s.find((function(e){return e.id===Number(r)})))){e.next=14;break}return(0,p.showMessage)({type:"failure",message:"'".concat(a.title,"' has already been added to Library")}),j.hide(),U(),e.abrupt("return");case 14:return e.next=16,(0,l.createMovies)({database:k,key:m.WATCHED_KEY,uid:y.currentUser.uid,data:[a]});case 16:j.hide(),(0,p.showMessage)({type:"success",message:"'".concat(a.title,"' is added to 'Watched'")}),U();case 19:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Q=function(){var t=e(s)(e(c).mark((function t(n){var r,a,o,s;return e(c).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.currentTarget.closest(".js-modal").dataset.id,a=x.find((function(e){return e.id===Number(r)})),j.show(),e.next=5,(0,l.readMovies)({database:k,key:m.WATCHED_KEY,uid:y.currentUser.uid});case 5:return o=e.sent,e.next=8,(0,l.readMovies)({database:k,key:m.QUEUE_KEY,uid:y.currentUser.uid});case 8:if(s=e.sent,!(null==o?void 0:o.find((function(e){return e.id===Number(r)})))&&!(null==s?void 0:s.find((function(e){return e.id===Number(r)})))){e.next=14;break}return(0,p.showMessage)({type:"failure",message:"'".concat(a.title,"' has already been added to Library")}),j.hide(),U(),e.abrupt("return");case 14:return e.next=16,(0,l.createMovies)({database:k,key:m.QUEUE_KEY,uid:y.currentUser.uid,data:[a]});case 16:j.hide(),(0,p.showMessage)({type:"success",message:"'".concat(a.title,"' is added to 'Queue'")}),U();case 19:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Y=function(){var t=e(s)(e(c).mark((function t(n){var r,a,o,s;return e(c).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),r=n.currentTarget.elements,a=r.email,o=r.password,s=r.method,console.log(s.value),"sign-up"!==s.value){e.next=8;break}return e.next=6,(0,g.createUserWithEmailAndPassword)(y,a.value,o.value).catch((function(e){console.log(e.code),console.log(e.message)}));case 6:e.next=11;break;case 8:if("sign-in"!==s.value){e.next=11;break}return e.next=11,(0,g.signInWithEmailAndPassword)(y,a.value,o.value).catch((function(e){console.log(e.code),console.log(e.message)}));case 11:T(),n.target.reset();case 13:case"end":return e.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();(0,g.onAuthStateChanged)(y,(function(e){e?(w.loginBtn.classList.add("is-hidden"),w.logoutBtn.classList.remove("is-hidden"),w.queueBtn.classList.remove("is-hidden"),w.watchedBtn.classList.remove("is-hidden")):(w.logoutBtn.classList.add("is-hidden"),w.loginBtn.classList.remove("is-hidden"),w.queueBtn.classList.add("is-hidden"),w.watchedBtn.classList.add("is-hidden"))})),w.form.addEventListener("submit",I),w.loadMoreBtn.addEventListener("click",D),w.gallery.addEventListener("click",(function(e){var t,n,r,a,o,s,i,c,d,l,f,p=e.target.closest("li").dataset.id;t=p,n=x.find((function(e){return e.id===Number(t)})),r=n.poster_path,a=n.title,o=n.vote_average,s=n.vote_count,i=n.popularity,c=n.original_title,d=n.genre_ids,l=n.overview,f=n.id,w.backdrop.querySelector(".js-img").src=r?"".concat(m.BASE_IMG).concat(r):"https://upload.wikimedia.org/wikipedia/commons/6/65/No-Image-Placeholder.svg",w.backdrop.querySelector(".js-title").textContent=a,w.backdrop.querySelector(".js-rating").textContent=o.toFixed(2),w.backdrop.querySelector(".js-votes").textContent=s,w.backdrop.querySelector(".js-popularity").textContent=i.toFixed(2),w.backdrop.querySelector(".js-original").textContent=c,w.backdrop.querySelector(".js-genre").textContent=0!==d.length?d.map((function(e){return u.default.find((function(t){return t.id===e})).name})).join(", "):"No information",w.backdrop.querySelector(".js-text").textContent=l,w.backdrop.querySelector(".js-modal").dataset.id=f,w.modal.classList.remove("is-hidden"),w.backdrop.classList.remove("is-hidden"),w.backdrop.addEventListener("click",_),document.body.addEventListener("keydown",C)})),w.modalCloseBtn.addEventListener("click",U),w.watchedBtn.addEventListener("click",W),w.queueBtn.addEventListener("click",Q),w.loginBtn.addEventListener("click",(function(e){w.loginModal.classList.remove("is-hidden"),w.backdrop.classList.remove("is-hidden"),w.backdrop.addEventListener("click",_),document.body.addEventListener("keydown",C)})),w.logoutBtn.addEventListener("click",(function(e){y.signOut()})),w.loginModalCloseBtn.addEventListener("click",T),w.loginForm.addEventListener("submit",Y),N().then(F)}();
//# sourceMappingURL=index.b4f1020f.js.map
