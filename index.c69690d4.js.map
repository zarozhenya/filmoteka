{"mappings":"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","sources":["src/index.js"],"sourcesContent":["import { getMoviesMarkup } from './js/templates';\nimport genres from './js/genres';\nimport { readMovies, createMovies } from './js/crud';\nimport { Loader } from './js/loader';\nimport { showMessage } from './js/showMessage';\n\nimport {\n  API_KEY,\n  BASE_URL,\n  BASE_IMG,\n  WATCHED_KEY,\n  QUEUE_KEY,\n} from './js/constants';\n\nimport { initializeApp } from 'firebase/app';\nimport {\n  getAuth,\n  createUserWithEmailAndPassword,\n  signInWithEmailAndPassword,\n  onAuthStateChanged,\n} from 'firebase/auth';\n\nimport { getDatabase } from 'firebase/database';\n\nconst firebaseConfig = {\n  apiKey: 'AIzaSyC4TFBFQRWUVazSJUXo0Z29XqKQGw3CwAA',\n  authDomain: 'filmoteka-29d04.firebaseapp.com',\n  projectId: 'filmoteka-29d04',\n  storageBucket: 'filmoteka-29d04.appspot.com',\n  messagingSenderId: '839332022784',\n  appId: '1:839332022784:web:20cca0e4887dab354326e5',\n  measurementId: 'G-8B53C0FEKF',\n  databaseURL:\n    'https://filmoteka-29d04-default-rtdb.europe-west1.firebasedatabase.app',\n};\n\n// Initialize Firebase\nconst app = initializeApp(firebaseConfig);\nconst auth = getAuth(app);\nconst database = getDatabase(app);\n\nconst refs = {\n  form: document.querySelector('form.header__form'),\n  gallery: document.querySelector('.movies-gallery'),\n  loadMoreBtn: document.querySelector('.js-load-more-btn'),\n  backdrop: document.querySelector('.backdrop'),\n  modal: document.querySelector('.js-modal'),\n  modalCloseBtn: document.querySelector('button.js-modal-close'),\n  watchedBtn: document.querySelector('.js-watched-btn'),\n  queueBtn: document.querySelector('.js-queue-btn'),\n  loginBtn: document.querySelector('.js-login-btn'),\n  logoutBtn: document.querySelector('.js-logout-btn'),\n  loginModal: document.querySelector('.js-login-modal'),\n  loginModalCloseBtn: document.querySelector('.js-login-close'),\n  loginForm: document.querySelector('.js-login-form'),\n  libraryLink: document.querySelector('.js-library-item'),\n};\n\nlet items = [];\nlet page = 1;\nlet query = '';\nlet currentResult = 0;\nlet totalResults = 0;\nlet searchByQuery = false;\nlet isAuthorized = false;\nconst loader = new Loader();\n\nconst showButton = () => {\n  refs.loadMoreBtn.classList.remove('hidden');\n};\nconst hideButton = () => {\n  refs.loadMoreBtn.classList.add('hidden');\n};\n\nconst onBackdropClick = e => {\n  if (e.target.classList.contains('backdrop')) {\n    hideModal();\n    hideLogin();\n  }\n};\n\nconst onKeyPress = e => {\n  if (e.code === 'Escape') {\n    hideModal();\n    hideLogin();\n  }\n};\n\nconst showModal = () => {\n  refs.modal.classList.remove('is-hidden');\n  refs.backdrop.classList.remove('is-hidden');\n\n  refs.backdrop.addEventListener('click', onBackdropClick);\n  document.body.addEventListener('keydown', onKeyPress);\n};\nconst hideModal = () => {\n  refs.backdrop.classList.add('is-hidden');\n  setTimeout(() => {\n    refs.modal.classList.add('is-hidden');\n  }, 200);\n  refs.backdrop.removeEventListener('click', onBackdropClick);\n  document.body.removeEventListener('keydown', onKeyPress);\n};\n\nconst showLogin = e => {\n  refs.loginModal.classList.remove('is-hidden');\n  refs.backdrop.classList.remove('is-hidden');\n  refs.backdrop.addEventListener('click', onBackdropClick);\n  document.body.addEventListener('keydown', onKeyPress);\n};\n\nconst hideLogin = e => {\n  refs.backdrop.classList.add('is-hidden');\n  setTimeout(() => {\n    refs.loginModal.classList.add('is-hidden');\n  }, 200);\n  refs.backdrop.removeEventListener('click', onBackdropClick);\n  document.body.removeEventListener('keydown', onKeyPress);\n};\n\nconst reset = () => {\n  page = 1;\n  query = '';\n  currentResult = 0;\n  totalResults = 0;\n  items = [];\n  showButton();\n};\n\nconst loadTrendingMovies = async () => {\n  loader.show();\n  const res = await fetch(\n    `${BASE_URL}/trending/movie/day?api_key=${API_KEY}&page=${page}`\n  );\n  const data = await res.json();\n  currentResult += data.results.length;\n  totalResults = data.total_results;\n  if (currentResult === totalResults) {\n    hideButton();\n  }\n  items = [...items, ...data.results];\n  loader.hide();\n};\n\nconst loadMoviesByQuery = async () => {\n  loader.show();\n  const res = await fetch(\n    `${BASE_URL}/search/movie?api_key=${API_KEY}&query=${query}&page=${page}`\n  );\n  const data = await res.json();\n  currentResult += data.results.length;\n  totalResults = data.total_results;\n  if (currentResult === totalResults) {\n    hideButton();\n  }\n  items = [...items, ...data.results];\n  loader.hide();\n};\n\nconst renderItems = () => {\n  const markup = getMoviesMarkup(items);\n  refs.gallery.innerHTML = markup;\n};\n\nconst renderModal = idMovie => {\n  const {\n    poster_path,\n    title,\n    vote_average,\n    vote_count,\n    popularity,\n    original_title,\n    genre_ids,\n    overview,\n    id,\n  } = items.find(({ id }) => id === Number(idMovie));\n  refs.backdrop.querySelector('.js-img').src = poster_path\n    ? `${BASE_IMG}${poster_path}`\n    : 'https://upload.wikimedia.org/wikipedia/commons/6/65/No-Image-Placeholder.svg';\n  refs.backdrop.querySelector('.js-title').textContent = title;\n  refs.backdrop.querySelector('.js-rating').textContent =\n    vote_average.toFixed(2);\n  refs.backdrop.querySelector('.js-votes').textContent = vote_count;\n  refs.backdrop.querySelector('.js-popularity').textContent =\n    popularity.toFixed(2);\n  refs.backdrop.querySelector('.js-original').textContent = original_title;\n  refs.backdrop.querySelector('.js-genre').textContent =\n    genre_ids.length !== 0\n      ? genre_ids\n          .map(idGenre => genres.find(({ id }) => id === idGenre).name)\n          .join(', ')\n      : 'No information';\n  refs.backdrop.querySelector('.js-text').textContent = overview;\n  refs.backdrop.querySelector('.js-modal').dataset.id = id;\n  if (isAuthorized) {\n    refs.queueBtn.classList.remove('is-hidden');\n    refs.watchedBtn.classList.remove('is-hidden');\n  } else {\n    refs.queueBtn.classList.add('is-hidden');\n    refs.watchedBtn.classList.add('is-hidden');\n  }\n};\n\nconst onFormSubmit = async e => {\n  e.preventDefault();\n  reset();\n  searchByQuery = true;\n  query = e.currentTarget.elements.query.value;\n  if (query) {\n    await onLoadMore();\n  }\n};\n\nconst onLoadMore = async () => {\n  if (searchByQuery) {\n    await loadMoviesByQuery();\n\n    page += 1;\n  } else {\n    page += 1;\n    await loadTrendingMovies();\n  }\n  renderItems();\n};\n\nconst onGalleryClick = e => {\n  const element = e.target;\n  const id = element.closest('li').dataset.id;\n  renderModal(id);\n  showModal();\n};\n\nconst onWatchedBtnClick = async e => {\n  const movieId = e.currentTarget.closest('.js-modal').dataset.id;\n  const movieData = items.find(({ id }) => id === Number(movieId));\n\n  loader.show();\n\n  const watchedMovies = await readMovies({\n    database,\n    key: WATCHED_KEY,\n    uid: auth.currentUser.uid,\n  });\n\n  const queueMovies = await readMovies({\n    database,\n    key: QUEUE_KEY,\n    uid: auth.currentUser.uid,\n  });\n\n  if (\n    watchedMovies?.find(({ id }) => id === Number(movieId)) ||\n    queueMovies?.find(({ id }) => id === Number(movieId))\n  ) {\n    showMessage({\n      type: 'failure',\n      message: `'${movieData.title}' has already been added to Library`,\n    });\n    loader.hide();\n    hideModal();\n    return;\n  }\n\n  await createMovies({\n    database,\n    key: WATCHED_KEY,\n    uid: auth.currentUser.uid,\n    data: [movieData],\n  });\n  loader.hide();\n  showMessage({\n    type: 'success',\n    message: `'${movieData.title}' is added to 'Watched'`,\n  });\n  hideModal();\n};\n\nconst onQueueBtnClick = async e => {\n  const movieId = e.currentTarget.closest('.js-modal').dataset.id;\n  const movieData = items.find(({ id }) => id === Number(movieId));\n\n  loader.show();\n\n  const watchedMovies = await readMovies({\n    database,\n    key: WATCHED_KEY,\n    uid: auth.currentUser.uid,\n  });\n\n  const queueMovies = await readMovies({\n    database,\n    key: QUEUE_KEY,\n    uid: auth.currentUser.uid,\n  });\n\n  if (\n    watchedMovies?.find(({ id }) => id === Number(movieId)) ||\n    queueMovies?.find(({ id }) => id === Number(movieId))\n  ) {\n    showMessage({\n      type: 'failure',\n      message: `'${movieData.title}' has already been added to Library`,\n    });\n    loader.hide();\n    hideModal();\n    return;\n  }\n\n  await createMovies({\n    database,\n    key: QUEUE_KEY,\n    uid: auth.currentUser.uid,\n    data: [movieData],\n  });\n  loader.hide();\n  showMessage({\n    type: 'success',\n    message: `'${movieData.title}' is added to 'Queue'`,\n  });\n  hideModal();\n};\n\nconst onLoginSubmit = async e => {\n  e.preventDefault();\n  const { email, password, method } = e.currentTarget.elements;\n  console.log(method.value);\n  if (method.value === 'sign-up') {\n    await createUserWithEmailAndPassword(\n      auth,\n      email.value,\n      password.value\n    ).catch(error => {\n      console.log(error.code);\n      console.log(error.message);\n    });\n  } else if (method.value === 'sign-in') {\n    await signInWithEmailAndPassword(auth, email.value, password.value).catch(\n      error => {\n        console.log(error.code);\n        console.log(error.message);\n      }\n    );\n  }\n  hideLogin();\n  e.target.reset();\n};\n\nconst onLogOut = e => {\n  auth.signOut();\n};\n\nonAuthStateChanged(auth, user => {\n  if (user) {\n    isAuthorized = true;\n    refs.loginBtn.classList.add('is-hidden');\n    refs.logoutBtn.classList.remove('is-hidden');\n  } else {\n    isAuthorized = false;\n    refs.logoutBtn.classList.add('is-hidden');\n    refs.loginBtn.classList.remove('is-hidden');\n  }\n});\n\nrefs.form.addEventListener('submit', onFormSubmit);\nrefs.loadMoreBtn.addEventListener('click', onLoadMore);\nrefs.gallery.addEventListener('click', onGalleryClick);\nrefs.modalCloseBtn.addEventListener('click', hideModal);\nrefs.watchedBtn.addEventListener('click', onWatchedBtnClick);\nrefs.queueBtn.addEventListener('click', onQueueBtnClick);\nrefs.loginBtn.addEventListener('click', showLogin);\nrefs.logoutBtn.addEventListener('click', onLogOut);\nrefs.loginModalCloseBtn.addEventListener('click', hideLogin);\nrefs.loginForm.addEventListener('submit', onLoginSubmit);\n\nloadTrendingMovies().then(renderItems);\n"],"names":["$bpxeT","parcelRequire","$b8f9b7833fa37166$var$app","$6Urw1","initializeApp","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","databaseURL","$b8f9b7833fa37166$var$auth","$3SEMc","getAuth","$b8f9b7833fa37166$var$database","$6Nu6u","getDatabase","$b8f9b7833fa37166$var$refs","form","document","querySelector","gallery","loadMoreBtn","backdrop","modal","modalCloseBtn","watchedBtn","queueBtn","loginBtn","logoutBtn","loginModal","loginModalCloseBtn","loginForm","libraryLink","$b8f9b7833fa37166$var$items","$b8f9b7833fa37166$var$page","$b8f9b7833fa37166$var$query","$b8f9b7833fa37166$var$currentResult","$b8f9b7833fa37166$var$totalResults","$b8f9b7833fa37166$var$searchByQuery","$b8f9b7833fa37166$var$isAuthorized","$b8f9b7833fa37166$var$loader","$kvC6y","Loader","$b8f9b7833fa37166$var$hideButton","classList","add","$b8f9b7833fa37166$var$onBackdropClick","e","target","contains","$b8f9b7833fa37166$var$hideModal","$b8f9b7833fa37166$var$hideLogin","$b8f9b7833fa37166$var$onKeyPress","code","setTimeout","removeEventListener","body","$b8f9b7833fa37166$var$reset","remove","$b8f9b7833fa37166$var$loadTrendingMovies","$parcel$interopDefault","$2TvXO","mark","_callee","res","data","show","fetch","concat","$4s6iC","BASE_URL","API_KEY","_ctx","sent","json","results","length","total_results","$8nrFW","hide","$b8f9b7833fa37166$var$loadMoviesByQuery","$b8f9b7833fa37166$var$renderItems","markup","$bfaTO","getMoviesMarkup","innerHTML","$b8f9b7833fa37166$var$onFormSubmit","preventDefault","currentTarget","elements","query","value","$b8f9b7833fa37166$var$onLoadMore","$b8f9b7833fa37166$var$onWatchedBtnClick","movieId","movieData","watchedMovies","queueMovies","closest","dataset","id","find","param","Number","$eBfQW","readMovies","database","key","WATCHED_KEY","uid","currentUser","QUEUE_KEY","$QXG35","showMessage","type","message","title","createMovies","$b8f9b7833fa37166$var$onQueueBtnClick","$b8f9b7833fa37166$var$onLoginSubmit","_elements","email","password","method","console","log","createUserWithEmailAndPassword","catch","error","signInWithEmailAndPassword","reset","onAuthStateChanged","user","addEventListener","idMovie","ref","poster_path","vote_average","vote_count","popularity","original_title","genre_ids","overview","id1","src","BASE_IMG","textContent","toFixed","map","idGenre","$twtVq","default","name","join","signOut","then"],"version":3,"file":"index.c69690d4.js.map"}