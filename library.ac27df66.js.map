{"mappings":"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","sources":["src/library.js"],"sourcesContent":["import { readMovies, deleteMovie, updateMovies } from './js/crud';\nimport { getMoviesMarkup } from './js/templates';\nimport { WATCHED_KEY, QUEUE_KEY, BASE_IMG } from './js/constants';\nimport genres from './js/genres';\nimport { showMessage } from './js/showMessage';\n\nconst refs = {\n  watchedBtn: document.querySelector('.js-watched-btn'),\n  queueBtn: document.querySelector('.js-queue-btn'),\n  gallery: document.querySelector('.js-gallery'),\n  backdrop: document.querySelector('.backdrop'),\n  closeBtn: document.querySelector('.js-modal-close'),\n  addToWatchedBtn: document.querySelector('.js-add-to-watched-btn'),\n  addToQueueBtn: document.querySelector('.js-add-to-queue-btn'),\n};\n\nlet items = [];\nlet currentPage = 'watched';\n\nconst showModal = () => {\n  refs.backdrop.classList.remove('is-hidden');\n};\nconst hideModal = () => {\n  refs.backdrop.classList.add('is-hidden');\n};\nconst changeBtnView = page => {\n  if (page === 'watched') {\n    refs.addToQueueBtn.textContent = 'add to queue';\n    refs.addToWatchedBtn.textContent = 'remove';\n  }\n  if (page === 'queue') {\n    refs.addToQueueBtn.textContent = 'remove';\n    refs.addToWatchedBtn.textContent = 'add to watched';\n  }\n};\n\nconst renderItems = () => {\n  const markup = getMoviesMarkup(items);\n  refs.gallery.innerHTML = markup;\n};\nconst renderModal = idMovie => {\n  const {\n    poster_path,\n    title,\n    vote_average,\n    vote_count,\n    popularity,\n    original_title,\n    genre_ids,\n    overview,\n    id,\n  } = items.find(({ id }) => id === Number(idMovie));\n  refs.backdrop.querySelector('.js-img').src = poster_path\n    ? `${BASE_IMG}${poster_path}`\n    : 'https://upload.wikimedia.org/wikipedia/commons/6/65/No-Image-Placeholder.svg';\n  refs.backdrop.querySelector('.js-title').textContent = title;\n  refs.backdrop.querySelector('.js-rating').textContent =\n    vote_average.toFixed(2);\n  refs.backdrop.querySelector('.js-votes').textContent = vote_count;\n  refs.backdrop.querySelector('.js-popularity').textContent =\n    popularity.toFixed(2);\n  refs.backdrop.querySelector('.js-original').textContent = original_title;\n  refs.backdrop.querySelector('.js-genre').textContent =\n    genre_ids.length !== 0\n      ? genre_ids\n          .map(idGenre => genres.find(({ id }) => id === idGenre).name)\n          .join(', ')\n      : 'No information';\n  refs.backdrop.querySelector('.js-text').textContent = overview;\n  refs.backdrop.querySelector('.js-modal').dataset.id = id;\n  changeBtnView(currentPage);\n};\n\nconst onWatchedBtnClick = e => {\n  refs.watchedBtn.classList.add('active');\n  refs.queueBtn.classList.remove('active');\n  currentPage = 'watched';\n  items = readMovies(WATCHED_KEY);\n  renderItems();\n};\nconst onQueueBtnClick = e => {\n  refs.queueBtn.classList.add('active');\n  refs.watchedBtn.classList.remove('active');\n  currentPage = 'queue';\n  items = readMovies(QUEUE_KEY);\n  renderItems();\n};\nconst onGalleryClick = e => {\n  const element = e.target;\n  const id = element.closest('li').dataset.id;\n  renderModal(id);\n  showModal();\n};\n\nconst onAddToWatchedBtnClick = e => {\n  const id = e.currentTarget.closest('.js-modal').dataset.id;\n  const movieData = items.find(({ id: movieId }) => movieId === Number(id));\n  if (currentPage === 'queue') {\n    updateMovies(WATCHED_KEY, movieData);\n    deleteMovie(QUEUE_KEY, id);\n    items = readMovies(QUEUE_KEY);\n    showMessage({\n      type: 'success',\n      message: `'${movieData.title}' is moved to 'Watched'`,\n    });\n  }\n  if (currentPage === 'watched') {\n    deleteMovie(WATCHED_KEY, id);\n    items = readMovies(WATCHED_KEY);\n    showMessage({\n      type: 'success',\n      message: `'${movieData.title}' is deleted`,\n    });\n  }\n  hideModal();\n\n  renderItems();\n};\n\nconst onAddToQueueBtn = e => {\n  const id = e.currentTarget.closest('.js-modal').dataset.id;\n  const movieData = items.find(({ id: movieId }) => movieId === Number(id));\n  if (currentPage === 'watched') {\n    updateMovies(QUEUE_KEY, movieData);\n    deleteMovie(WATCHED_KEY, id);\n    items = readMovies(WATCHED_KEY);\n    showMessage({\n      type: 'success',\n      message: `'${movieData.title}' is moved to 'Queue'`,\n    });\n  }\n  if (currentPage === 'queue') {\n    deleteMovie(QUEUE_KEY, id);\n    items = readMovies(QUEUE_KEY);\n    showMessage({\n      type: 'success',\n      message: `'${movieData.title}' is deleted`,\n    });\n  }\n  hideModal();\n\n  renderItems();\n};\n\nrefs.watchedBtn.addEventListener('click', onWatchedBtnClick);\nrefs.queueBtn.addEventListener('click', onQueueBtnClick);\nrefs.gallery.addEventListener('click', onGalleryClick);\nrefs.closeBtn.addEventListener('click', hideModal);\nrefs.addToWatchedBtn.addEventListener('click', onAddToWatchedBtnClick);\nrefs.addToQueueBtn.addEventListener('click', onAddToQueueBtn);\n\nonWatchedBtnClick();\n"],"names":["$eBfQW","parcelRequire","$cecbdd76f2d3d4bd$var$refs","watchedBtn","document","querySelector","queueBtn","gallery","backdrop","closeBtn","addToWatchedBtn","addToQueueBtn","$cecbdd76f2d3d4bd$var$items","$cecbdd76f2d3d4bd$var$currentPage","$cecbdd76f2d3d4bd$var$hideModal","classList","add","$cecbdd76f2d3d4bd$var$renderItems","markup","$bfaTO","getMoviesMarkup","innerHTML","$cecbdd76f2d3d4bd$var$renderModal","idMovie","page","ref","find","param","id","Number","poster_path","title","vote_average","vote_count","popularity","original_title","genre_ids","overview","id1","src","concat","$4s6iC","BASE_IMG","textContent","toFixed","length","map","idGenre","$twtVq","default","name","join","dataset","$cecbdd76f2d3d4bd$var$onWatchedBtnClick","e","remove","readMovies","WATCHED_KEY","addEventListener","QUEUE_KEY","target","closest","currentTarget","movieData","updateMovies","deleteMovie","$QXG35","showMessage","type","message"],"version":3,"file":"library.ac27df66.js.map"}