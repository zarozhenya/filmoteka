function e(e){return e&&e.__esModule?e.default:e}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},a={},r={},o=t.parcelRequired7c6;null==o&&((o=function(e){if(e in a)return a[e].exports;if(e in r){var t=r[e];delete r[e];var o={id:e,exports:{}};return a[e]=o,t.call(o.exports,o,o.exports),o.exports}var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}).register=function(e,t){r[e]=t},t.parcelRequired7c6=o),o.register("auXem",(function(e,t){function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e){if(!("string"==typeof e||e instanceof String)){var t=a(e);throw null===e?t="null":"object"===t&&(t=e.constructor.name),new TypeError("Expected a string but received a ".concat(t))}},e.exports=e.exports.default,e.exports.default=e.exports.default})),o.register("fTSTg",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;for(var a in t)void 0===e[a]&&(e[a]=t[a]);return e},e.exports=e.exports.default,e.exports.default=e.exports.default})),o.register("jBPw5",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e,t){var a,o;(0,r.default)(e),"object"===n(t)?(a=t.min||0,o=t.max):(a=arguments[1],o=arguments[2]);var s=encodeURI(e).split(/%..|./).length-1;return s>=a&&(void 0===o||s<=o)};var a,r=(a=o("auXem"))&&a.__esModule?a:{default:a};function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}e.exports=e.exports.default,e.exports.default=e.exports.default})),o.register("e9Fiv",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e,t){(0,a.default)(e),(t=(0,r.default)(t,s)).allow_trailing_dot&&"."===e[e.length-1]&&(e=e.substring(0,e.length-1));!0===t.allow_wildcard&&0===e.indexOf("*.")&&(e=e.substring(2));var o=e.split("."),n=o[o.length-1];if(t.require_tld){if(o.length<2)return!1;if(!/^([a-z\u00A1-\u00A8\u00AA-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}|xn[a-z0-9-]{2,})$/i.test(n))return!1;if(/\s/.test(n))return!1}return!(!t.allow_numeric_tld&&/^\d+$/.test(n))&&o.every((function(e){return!(e.length>63)&&(!!/^[a-z_\u00a1-\uffff0-9-]+$/i.test(e)&&(!/[\uff01-\uff5e]/.test(e)&&(!/^-|-$/.test(e)&&!(!t.allow_underscores&&/_/.test(e)))))}))};var a=n(o("auXem")),r=n(o("fTSTg"));function n(e){return e&&e.__esModule?e:{default:e}}var s={require_tld:!0,allow_underscores:!1,allow_trailing_dot:!1,allow_numeric_tld:!1,allow_wildcard:!1};e.exports=e.exports.default,e.exports.default=e.exports.default})),o.register("7q3Hx",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if((0,r.default)(t),!(a=String(a)))return e(t,4)||e(t,6);if("4"===a){if(!i.test(t))return!1;var o=t.split(".").sort((function(e,t){return e-t}));return o[3]<=255}return"6"===a&&!!l.test(t)};var a,r=(a=o("auXem"))&&a.__esModule?a:{default:a};var n="(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])",s="(".concat(n,"[.]){3}").concat(n),i=new RegExp("^".concat(s,"$")),d="(?:[0-9a-fA-F]{1,4})",l=new RegExp("^("+"(?:".concat(d,":){7}(?:").concat(d,"|:)|")+"(?:".concat(d,":){6}(?:").concat(s,"|:").concat(d,"|:)|")+"(?:".concat(d,":){5}(?::").concat(s,"|(:").concat(d,"){1,2}|:)|")+"(?:".concat(d,":){4}(?:(:").concat(d,"){0,1}:").concat(s,"|(:").concat(d,"){1,3}|:)|")+"(?:".concat(d,":){3}(?:(:").concat(d,"){0,2}:").concat(s,"|(:").concat(d,"){1,4}|:)|")+"(?:".concat(d,":){2}(?:(:").concat(d,"){0,3}:").concat(s,"|(:").concat(d,"){1,5}|:)|")+"(?:".concat(d,":){1}(?:(:").concat(d,"){0,4}:").concat(s,"|(:").concat(d,"){1,6}|:)|")+"(?::((?::".concat(d,"){0,5}:").concat(s,"|(?::").concat(d,"){1,7}|:))")+")(%[0-9a-zA-Z-.:]{1,})?$");e.exports=e.exports.default,e.exports.default=e.exports.default}));var n=o("7sOwA"),s=o("ezyJp"),i=o("3nphs"),d=o("gjiCh"),l=o("2PXHr"),u={};Object.defineProperty(u,"__esModule",{value:!0}),u.default=function(e,t){if((0,c.default)(e),(t=(0,f.default)(t,v)).require_display_name||t.allow_display_name){var a=e.match(h);if(a){var r=a[1];if(e=e.replace(r,"").replace(/(^<|>$)/g,""),r.endsWith(" ")&&(r=r.substr(0,r.length-1)),!function(e){var t=e.replace(/^"(.+)"$/,"$1");if(!t.trim())return!1;if(/[\.";<>]/.test(t)){if(t===e)return!1;if(!(t.split('"').length===t.split('\\"').length))return!1}return!0}(r))return!1}else if(t.require_display_name)return!1}if(!t.ignore_max_length&&e.length>254)return!1;var o=e.split("@"),n=o.pop(),s=n.toLowerCase();if(t.host_blacklist.includes(s))return!1;var i=o.join("@");if(t.domain_specific_validation&&("gmail.com"===s||"googlemail.com"===s)){var d=(i=i.toLowerCase()).split("+")[0];if(!(0,p.default)(d.replace(/\./g,""),{min:6,max:30}))return!1;for(var l=d.split("."),u=0;u<l.length;u++)if(!_.test(l[u]))return!1}if(!(!1!==t.ignore_max_length||(0,p.default)(i,{max:64})&&(0,p.default)(n,{max:254})))return!1;if(!(0,m.default)(n,{require_tld:t.require_tld})){if(!t.allow_ip_domain)return!1;if(!(0,g.default)(n)){if(!n.startsWith("[")||!n.endsWith("]"))return!1;var y=n.substr(1,n.length-2);if(0===y.length||!(0,g.default)(y))return!1}}if('"'===i[0])return i=i.slice(1,i.length-1),t.allow_utf8_local_part?k.test(i):x.test(i);for(var F=t.allow_utf8_local_part?w:b,E=i.split("."),L=0;L<E.length;L++)if(!F.test(E[L]))return!1;if(t.blacklisted_chars&&-1!==i.search(new RegExp("[".concat(t.blacklisted_chars,"]+"),"g")))return!1;return!0};var c=y(o("auXem")),f=y(o("fTSTg")),p=y(o("jBPw5")),m=y(o("e9Fiv")),g=y(o("7q3Hx"));function y(e){return e&&e.__esModule?e:{default:e}}var v={allow_display_name:!1,require_display_name:!1,allow_utf8_local_part:!0,require_tld:!0,blacklisted_chars:"",ignore_max_length:!1,host_blacklist:[]},h=/^([^\x00-\x1F\x7F-\x9F\cX]+)</i,b=/^[a-z\d!#\$%&'\*\+\-\/=\?\^_`{\|}~]+$/i,_=/^[a-z\d]+$/,x=/^([\s\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e]|(\\[\x01-\x09\x0b\x0c\x0d-\x7f]))*$/i,w=/^[a-z\d!#\$%&'\*\+\-\/=\?\^_`{\|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+$/i,k=/^([\s\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|(\\[\x01-\x09\x0b\x0c\x0d-\x7f\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))*$/i;(u=u.default).default=u.default;var F=o("8G1wF"),E=o("25RCP"),L=o("amyG6"),q=o("fQ3Fn");const S=(0,E.initializeApp)({apiKey:"AIzaSyC4TFBFQRWUVazSJUXo0Z29XqKQGw3CwAA",authDomain:"filmoteka-29d04.firebaseapp.com",projectId:"filmoteka-29d04",storageBucket:"filmoteka-29d04.appspot.com",messagingSenderId:"839332022784",appId:"1:839332022784:web:20cca0e4887dab354326e5",measurementId:"G-8B53C0FEKF",databaseURL:"https://filmoteka-29d04-default-rtdb.europe-west1.firebasedatabase.app"}),M=(0,L.getAuth)(S),j=(0,q.getDatabase)(S),B={form:document.querySelector("form.header__form"),gallery:document.querySelector(".movies-gallery"),loadMoreBtn:document.querySelector(".js-load-more-btn"),backdrop:document.querySelector(".backdrop"),modal:document.querySelector(".js-modal"),modalCloseBtn:document.querySelector("button.js-modal-close"),watchedBtn:document.querySelector(".js-watched-btn"),queueBtn:document.querySelector(".js-queue-btn"),loginBtn:document.querySelector(".js-login-btn"),logoutBtn:document.querySelector(".js-logout-btn"),loginModal:document.querySelector(".js-login-modal"),loginModalCloseBtn:document.querySelector(".js-login-close"),loginForm:document.querySelector(".js-login-form"),libraryLink:document.querySelector(".js-library-item")};let $=[],C=1,A="",T=0,U=0,D=!1;const P=new(0,d.Loader),O=()=>{B.loadMoreBtn.classList.add("hidden")},z=e=>{e.target.classList.contains("backdrop")&&(K(),N())},I=e=>{"Escape"===e.code&&(K(),N())},K=()=>{B.backdrop.classList.add("is-hidden"),setTimeout((()=>{B.modal.classList.add("is-hidden")}),200),B.backdrop.removeEventListener("click",z),document.body.removeEventListener("keydown",I)},N=e=>{B.backdrop.classList.add("is-hidden"),setTimeout((()=>{B.loginModal.classList.add("is-hidden")}),200),B.backdrop.removeEventListener("click",z),document.body.removeEventListener("keydown",I)},R=()=>{C=1,A="",T=0,U=0,$=[],B.loadMoreBtn.classList.remove("hidden")},W=async()=>{P.show();const e=await fetch(`${F.BASE_URL}/trending/movie/day?api_key=${F.API_KEY}&page=${C}`),t=await e.json();T+=t.results.length,U=t.total_results,T===U&&O(),$=[...$,...t.results],P.hide()},X=()=>{const e=(0,n.getMoviesMarkup)($);B.gallery.innerHTML=e},Y=async()=>{D?(await(async()=>{P.show();const e=await fetch(`${F.BASE_URL}/search/movie?api_key=${F.API_KEY}&query=${A}&page=${C}`),t=await e.json();T+=t.results.length,U=t.total_results,T===U&&O(),$=[...$,...t.results],P.hide()})(),C+=1):(C+=1,await W()),X()};(0,L.onAuthStateChanged)(M,(e=>{e?(B.loginBtn.classList.add("is-hidden"),B.logoutBtn.classList.remove("is-hidden"),B.queueBtn.classList.remove("is-hidden"),B.watchedBtn.classList.remove("is-hidden")):(B.logoutBtn.classList.add("is-hidden"),B.loginBtn.classList.remove("is-hidden"),B.queueBtn.classList.add("is-hidden"),B.watchedBtn.classList.add("is-hidden"))})),B.form.addEventListener("submit",(async e=>{e.preventDefault(),R(),D=!0,A=e.currentTarget.elements.query.value,A&&await Y()})),B.loadMoreBtn.addEventListener("click",Y),B.gallery.addEventListener("click",(e=>{(e=>{const{poster_path:t,title:a,vote_average:r,vote_count:o,popularity:n,original_title:i,genre_ids:d,overview:l,id:u}=$.find((({id:t})=>t===Number(e)));B.backdrop.querySelector(".js-img").src=t?`${F.BASE_IMG}${t}`:"https://upload.wikimedia.org/wikipedia/commons/6/65/No-Image-Placeholder.svg",B.backdrop.querySelector(".js-title").textContent=a,B.backdrop.querySelector(".js-rating").textContent=r.toFixed(2),B.backdrop.querySelector(".js-votes").textContent=o,B.backdrop.querySelector(".js-popularity").textContent=n.toFixed(2),B.backdrop.querySelector(".js-original").textContent=i,B.backdrop.querySelector(".js-genre").textContent=0!==d.length?d.map((e=>s.default.find((({id:t})=>t===e)).name)).join(", "):"No information",B.backdrop.querySelector(".js-text").textContent=l,B.backdrop.querySelector(".js-modal").dataset.id=u})(e.target.closest("li").dataset.id),B.modal.classList.remove("is-hidden"),B.backdrop.classList.remove("is-hidden"),B.backdrop.addEventListener("click",z),document.body.addEventListener("keydown",I)})),B.modalCloseBtn.addEventListener("click",K),B.watchedBtn.addEventListener("click",(async e=>{const t=e.currentTarget.closest(".js-modal").dataset.id,a=$.find((({id:e})=>e===Number(t)));P.show();const r=await(0,i.readMovies)({database:j,key:F.WATCHED_KEY,uid:M.currentUser.uid}),o=await(0,i.readMovies)({database:j,key:F.QUEUE_KEY,uid:M.currentUser.uid});if((null==r?void 0:r.find((({id:e})=>e===Number(t))))||(null==o?void 0:o.find((({id:e})=>e===Number(t)))))return(0,l.showMessage)({type:"failure",message:`'${a.title}' has already been added to Library`}),P.hide(),void K();await(0,i.createMovies)({database:j,key:F.WATCHED_KEY,uid:M.currentUser.uid,data:[a]}),P.hide(),(0,l.showMessage)({type:"success",message:`'${a.title}' is added to 'Watched'`}),K()})),B.queueBtn.addEventListener("click",(async e=>{const t=e.currentTarget.closest(".js-modal").dataset.id,a=$.find((({id:e})=>e===Number(t)));P.show();const r=await(0,i.readMovies)({database:j,key:F.WATCHED_KEY,uid:M.currentUser.uid}),o=await(0,i.readMovies)({database:j,key:F.QUEUE_KEY,uid:M.currentUser.uid});if((null==r?void 0:r.find((({id:e})=>e===Number(t))))||(null==o?void 0:o.find((({id:e})=>e===Number(t)))))return(0,l.showMessage)({type:"failure",message:`'${a.title}' has already been added to Library`}),P.hide(),void K();await(0,i.createMovies)({database:j,key:F.QUEUE_KEY,uid:M.currentUser.uid,data:[a]}),P.hide(),(0,l.showMessage)({type:"success",message:`'${a.title}' is added to 'Queue'`}),K()})),B.loginBtn.addEventListener("click",(e=>{B.loginModal.classList.remove("is-hidden"),B.backdrop.classList.remove("is-hidden"),B.backdrop.addEventListener("click",z),document.body.addEventListener("keydown",I)})),B.logoutBtn.addEventListener("click",(e=>{M.signOut()})),B.loginModalCloseBtn.addEventListener("click",N),B.loginForm.addEventListener("submit",(async t=>{t.preventDefault();const{email:a,password:r,method:o}=t.currentTarget.elements;e(u)(a.value)?"sign-up"===o.value?await(0,L.createUserWithEmailAndPassword)(M,a.value,r.value).then((()=>{N(),t.target.reset()})).catch((e=>{"auth/email-already-in-use"===e.code&&(0,l.showMessage)({type:"failure",message:"This email is already in use"})})):"sign-in"===o.value&&await(0,L.signInWithEmailAndPassword)(M,a.value,r.value).then((()=>{N(),t.target.reset()})).catch((e=>{"auth/too-many-requests"===e.code&&(0,l.showMessage)({type:"failure",message:"Too many requests"}),"auth/wrong-password"===e.code&&(0,l.showMessage)({type:"failure",message:"Wrong password"}),"auth/user-not-found"===e.code&&(0,l.showMessage)({type:"failure",message:"User not found"})})):(0,l.showMessage)({type:"failure",message:"You have to enter a valid email address"})})),W().then(X);
//# sourceMappingURL=index.b832c99b.js.map
